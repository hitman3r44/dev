what,kind,bundleId,bundleVersion,description,time
started,bundle,org.eclipse.wst.ws,1.1.203.v201004211805,"org.eclipse.wst.ws",1403192490627
started,bundle,org.eclipse.wst.ws.service.policy,1.0.204.v201011011834,"org.eclipse.wst.ws.service.policy",1403192490643
executed,command,org.eclipse.wst.server.ui,1.1.207.v20110119,"org.eclipse.wst.server.run",1403192529144
opened,view,org.eclipse.ui.console,3.5.0.v20100526,"org.eclipse.ui.console.ConsoleView",1403192530610
activated,view,org.eclipse.ui.console,3.5.0.v20100526,"org.eclipse.ui.console.ConsoleView",1403192530626
activated,view,org.eclipse.wst.server.ui,1.1.207.v20110119,"org.eclipse.wst.server.ui.ServersView",1403192532248
activated,view,org.eclipse.ui.console,3.5.0.v20100526,"org.eclipse.ui.console.ConsoleView",1403192533902
deactivated,workbench,org.eclipse.ui.workbench,3.6.2.M20110210-1200,"",1403192545012
activated,workbench,org.eclipse.ui.workbench,3.6.2.M20110210-1200,"",1403192550488
deactivated,workbench,org.eclipse.ui.workbench,3.6.2.M20110210-1200,"",1403192552937
activated,workbench,org.eclipse.ui.workbench,3.6.2.M20110210-1200,"",1403192563316
started,bundle,org.eclipse.wst.xml.ui,1.1.103.v201101122108,"org.eclipse.wst.xml.ui",1403192563487
started,bundle,org.eclipse.jst.jsp.ui,1.1.503.v201101262228,"org.eclipse.jst.jsp.ui",1403192563487
started,bundle,org.eclipse.wst.jsdt.web.support.jsp,1.0.303.v201012160047,"org.eclipse.wst.jsdt.web.support.jsp",1403192563675
started,bundle,org.eclipse.wst.jsdt.web.ui,1.0.304.v201012160349,"org.eclipse.wst.jsdt.web.ui",1403192563675
started,bundle,org.eclipse.jst.jsf.facelet.ui,1.0.0.v20100602,"org.eclipse.jst.jsf.facelet.ui",1403192563737
started,bundle,org.eclipse.jst.jsf.ui,1.3.1.v20100906,"org.eclipse.jst.jsf.ui",1403192563737
started,bundle,org.eclipse.wst.jsdt.manipulation,1.0.200.v201004150600,"org.eclipse.wst.jsdt.manipulation",1403192563784
started,bundle,org.eclipse.wst.jsdt.ui,1.1.4.v201102160540,"org.eclipse.wst.jsdt.ui",1403192563784
started,bundle,org.eclipse.wst.css.ui,1.0.502.v201101122002,"org.eclipse.wst.css.ui",1403192563799
started,bundle,org.eclipse.wst.dtd.ui,1.0.500.v201004290328,"org.eclipse.wst.dtd.ui",1403192563877
started,bundle,org.eclipse.wst.jsdt.web.core,1.0.304.v201102160550,"org.eclipse.wst.jsdt.web.core",1403192563893
opened,editor,org.eclipse.jst.jsp.ui,1.1.503.v201101262228,"org.eclipse.jst.jsp.core.jspsource.source",1403192564033
activated,editor,org.eclipse.jst.jsp.ui,1.1.503.v201101262228,"org.eclipse.jst.jsp.core.jspsource.source",1403192564143
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.copy",1403192602055
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.copy",1403192602538
activated,editor,org.eclipse.jdt.ui,3.6.2.r362_v20110203,"org.eclipse.jdt.ui.CompilationUnitEditor",1403192604223
deactivated,workbench,org.eclipse.ui.workbench,3.6.2.M20110210-1200,"",1403192608544
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.findReplace",1403192608560
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.paste",1403192610291
activated,workbench,org.eclipse.ui.workbench,3.6.2.M20110210-1200,"",1403192626094
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.copy",1403192629511
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.paste",1403192637857
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.copy",1403192670601
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.copy",1403192670882
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.paste",1403192674252
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.copy",1403192682239
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.copy",1403192682426
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.paste",1403192709913
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.copy",1403192717651
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.copy",1403192718025
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.paste",1403192719772
started,bundle,org.eclipse.jdt.junit.core,3.6.1.r361_v20100825-0800,"org.eclipse.jdt.junit.core",1403192724109
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.file.save",1403192725139
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.copy",1403192779462
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.copy",1403192779727
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.paste",1403192785858
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.cut",1403192825248
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.paste",1403192832455
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.copy",1403192839195
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.copy",1403192839429
activated,editor,org.eclipse.jst.jsp.ui,1.1.503.v201101262228,"org.eclipse.jst.jsp.core.jspsource.source",1403192841238
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.paste",1403192863453
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.copy",1403192875402
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.copy",1403192875683
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.paste",1403192878585
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.cut",1403192881315
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.paste",1403192883530
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.file.save",1403192886697
activated,view,org.eclipse.wst.server.ui,1.1.207.v20110119,"org.eclipse.wst.server.ui.ServersView",1403192890550
executed,command,org.eclipse.wst.server.ui,1.1.207.v20110119,"org.eclipse.wst.server.stop",1403192890659
activated,editor,org.eclipse.jdt.ui,3.6.2.r362_v20110203,"org.eclipse.jdt.ui.CompilationUnitEditor",1403192893017
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.file.saveAll",1403192895060
activated,view,org.eclipse.wst.server.ui,1.1.207.v20110119,"org.eclipse.wst.server.ui.ServersView",1403192897322
deactivated,workbench,org.eclipse.ui.workbench,3.6.2.M20110210-1200,"",1403192901316
activated,workbench,org.eclipse.ui.workbench,3.6.2.M20110210-1200,"",1403192902720
deactivated,workbench,org.eclipse.ui.workbench,3.6.2.M20110210-1200,"",1403192908274
activated,workbench,org.eclipse.ui.workbench,3.6.2.M20110210-1200,"",1403192909584
deactivated,workbench,org.eclipse.ui.workbench,3.6.2.M20110210-1200,"",1403192909943
activated,workbench,org.eclipse.ui.workbench,3.6.2.M20110210-1200,"",1403192918757
deactivated,workbench,org.eclipse.ui.workbench,3.6.2.M20110210-1200,"",1403192925480
activated,workbench,org.eclipse.ui.workbench,3.6.2.M20110210-1200,"",1403192926791
executed,command,org.eclipse.ui.ide,3.6.2.M20101201-0800,"org.eclipse.ui.project.cleanAction",1403192926791
deactivated,workbench,org.eclipse.ui.workbench,3.6.2.M20110210-1200,"",1403192927087
activated,workbench,org.eclipse.ui.workbench,3.6.2.M20110210-1200,"",1403192927415
error,log,,,"Exception occurred during problem detection:\n----------------------------------- SOURCE BEGIN -------------------------------------\npackage com.loyauty.web.struts.action.product;\n\nimport java.text.DecimalFormat;\nimport java.text.NumberFormat;\nimport java.util.Locale;\nimport java.util.List;\n\nimport lombok.Getter;\nimport lombok.Setter;\n\nimport com.loyauty.enums.GroupCategoryEnum;\nimport com.loyauty.enums.ProductStatus;\nimport com.loyauty.enums.UserType;\nimport com.loyauty.exception.ServiceException;\nimport com.loyauty.exception.ServiceLocatorException;\nimport com.loyauty.model.UserProductPrice;\nimport com.loyauty.service.core.dto.ImageDTO;\nimport com.loyauty.service.core.dto.BrandDTO;\nimport com.loyauty.service.core.dto.ProductDTO;\nimport com.loyauty.service.core.dto.ProvinceDTO;\nimport com.loyauty.service.core.dto.ShippingTotalDTO;\nimport com.loyauty.service.core.dto.ProductModelDTO;\nimport com.loyauty.service.core.dto.SpecificationDTO;\nimport com.loyauty.service.core.dto.UserProductPriceDTO;\nimport com.loyauty.service.core.dto.UserSessionDTO;\nimport com.loyauty.service.orders.OrdersService;\nimport com.loyauty.service.product.ProductService;\nimport com.loyauty.service.specification.SpecificationService;\nimport com.loyauty.web.RequestAtributeConstants;\nimport com.loyauty.web.WebConstants;\nimport com.loyauty.web.struts.action.LoyautyAction;\nimport com.loyauty.web.util.SeoUrlsMaker;\n\npublic class Product extends LoyautyAction {\n\t\n\tprivate static final long serialVersionUID = 1L;\n\t\n\tprivate static final String UNION = ""_"";\n\tprivate static final char CHAR_PATTERN_THAT_REPEATS = '_';\n\t\n\tprivate ProductService productService;\n\tprivate SpecificationService specificationService;\n\t\n\t@Getter @Setter\n\tprivate ProductDTO productDTO;\n\t@Getter @Setter\n\tprivate BrandDTO brandDTO;\n\t@Getter @Setter\n\tprivate ImageDTO productImageDTO;\n\t@Getter @Setter\n\tprivate ImageDTO brandImageDTO;\n\t@Getter @Setter\n\tprivate String productImageName;\n\t@Getter @Setter\n\tprivate String brandImageName;\n\t@Getter @Setter\n\tprivate long productId;\n\t@Getter @Setter\n\tprivate String productName;\n\t@Getter @Setter\n\tprivate String desc;\t\n\t@Getter @Setter\n\tprivate String spec;\n\t@Getter @Setter\n\tprivate String other;\n\t@Getter @Setter\n\tprivate String loyaltyProductId;\n\t@Getter @Setter\n\tprivate String loyaltyProductIdWithountPrefix;\n\t@Getter @Setter\n\tprivate String weight;\n\t@Getter @Setter\n\tprivate String w;\n\t@Getter @Setter\n\tprivate String l;\n\t@Getter @Setter\n\tprivate String h;\t\n\t@Getter @Setter\n\tprivate String modelNumber;\n\t@Getter @Setter\n\tprivate String price;\t\n\t@Getter @Setter\n\tprivate String msrp;\n\t@Getter @Setter\n\tprivate String discount;\n\t@Getter @Setter\n\tprivate String percentage;\t\n\t@Getter @Setter\n\tprivate String productBreadcrumb;\n\t@Getter @Setter\n\tprivate String groupName;\n\t@Getter @Setter\n\tprivate String groupHL;\n\t@Getter @Setter\n\tprivate String categoryName;\n\t@Getter @Setter\n\tprivate String categoryHL;\n\t@Getter @Setter\n\tprivate String specName;\n\t@Getter @Setter\n\tprivate String specHL;\t\n\t@Getter @Setter\n\tprivate String warranty;\t\n\t@Getter @Setter\n\tprivate String hrefName;\n\t@Getter @Setter\n\tprivate String link;\n\t@Getter @Setter\n\tprivate String warning;\n\t@Getter @Setter\n\tprivate String warning2;\t\n\t@Getter @Setter\n\tprivate String writeWarning;\n\t@Getter @Setter\n\tprivate String loyaltyProductIdSub;\n\t@Getter @Setter\n\tprivate String newLSProductIdSubHRef;\n\t\n\t@Getter @Setter\n\tprivate String sendRestricted;\n\t\n\t@Getter @Setter\n\tprivate Long numberOfProductModelElements;\n\t\n\t@Getter @Setter\n\tprivate List<ShippingTotalDTO> provinceNameList;\n\t@Getter @Setter\n\tprivate String[] provinceName;\t\n\t@Getter @Setter\n\tString[] shippingCost;\n\t@Getter @Setter\n\tprivate String shippingTotalCanada;\n\t\n\tpublic Product() throws ServiceLocatorException {\n\t\tsuper();\n\t\tproductService = getServiceLocator().getProductService();\t\n\t\tspecificationService = getServiceLocator().getSpecificationService();\n\t}\t\n\t\n\t@Override  \n\tpublic String execute() throws Exception {\n\t\ttry {\n\t\t\tUserSessionDTO userSessionDTO = (UserSessionDTO)request.getSession().getAttribute(WebConstants.USER);\n\t\t\t\n\t\t\tif (userSessionDTO != null) {\n\t\t\t\tproductDTO = productService.getProductInformation(productId, userSessionDTO.getId());\n\t\t\t\tproductBreadcrumb = ""Our Products"";\t\t\t\t\n\t\t\t} else {\n\t\t\t\tproductDTO = productService.getProductInformation(productId, null);\n\t\t\t\tproductBreadcrumb = ""Products"";\n\t\t\t}\n\t\t\t\n\t\t\tproductImageDTO = productDTO.getImage();\n\t\t\tproductImageName = productImageDTO != null ? productImageDTO.getName() : """";\n\t\t\t\n\t\t\tif (productDTO.getBrand() != null) {\n\t\t\t\tbrandDTO = productDTO.getBrand();\n\t\t\t\t\n\t\t\t\tproductDTO.getBrand().setHrefName(SeoUrlsMaker.getBrandUrl(brandDTO.getName(), brandDTO.getId()));\n\t\t\t\t\n\t\t\t\tif (brandDTO.getImage() != null) {\n\t\t\t\t\tbrandImageDTO = brandDTO.getImage();\n\t\t\t\t\tif (brandImageDTO != null) {\n\t\t\t\t\t\tbrandImageName = brandImageDTO.getName();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbrandImageName = """";\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tbrandImageName = """";\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tbrandImageName = """";\n\t\t\t}\n\t\t\t\n\t\t\tif (getCurrentLanguage().equals(WebConstants.ENGLISH_LANGUAGE)) {\n\t\t\t\tproductName = productDTO.getNameEng().getName();\n\t\t\t\tdesc = productDTO.getDescriptionEng().getName();\n\t\t\t\tspec = productDTO.getSpecificationEng().getName();\n\t\t\t\tother = productDTO.getOtherEng().getName();\n\t\t\t\twarranty = (productDTO.getWarrantyEng() != null) ? productDTO.getWarrantyEng().getName() : """";\n\t\t\t} else if (getCurrentLanguage().equals(WebConstants.FRENCH_LANGUAGE)) { \n\t\t\t\tproductName = productDTO.getNameFr().getName();\n\t\t\t\tdesc = productDTO.getDescriptionFr().getName();\n\t\t\t\tspec = productDTO.getSpecificationFr().getName();\n\t\t\t\tother = productDTO.getSpecificationFr().getName();\n\t\t\t\twarranty = (productDTO.getWarrantyFr() != null) ? productDTO.getWarrantyFr().getName() : """";\n\t\t\t}\n\t\t\t\n\t\t\t//Link url \n\t\t\tif(productDTO.getLinkList().size() > 0)\n\t\t\t\tlink = productDTO.getLinkList().get(0).getLink();\n\n\t\t\tif (desc.indexOf(""<p></p>"") != -1 && desc.length() == 7) desc = desc.replaceAll(""<p></p>"", """");\n\t\t\tif (spec.indexOf(""<p></p>"") != -1 && spec.length() == 7) spec = spec.replaceAll(""<p></p>"", """");\n\t\t\t\n\t\t\tInteger status = productDTO.getStatus().getValue();\n\t\t\tif (status == ProductStatus.UNAVAILABLE.getValue()) {\n\t\t\t\twriteWarning = ""y2"";\n\t\t\t\twarning = ""PRODUCT TEMPORARILY UNAVAILABLE"";\n\t\t\t} else if (status == ProductStatus.DISCONTINUED.getValue()) {\n\t\t\t\twriteWarning = ""y3"";\n\t\t\t\tloyaltyProductIdSub = productDTO.getLoyaltyProductIdSub();\n\t\t\t\twarning = ""THIS PRODUCT IS DISCONTINUED"";\n\t\t\t\t\n\t\t\t\tif (!loyaltyProductIdSub.matches(""^\\\\s*$"")) {\n\t\t\t\t\twarning2 = ""Please view our suggested replacement: "";\n\t\t\t\t\tProductDTO newProductDTO = productService.getProductIdFromLSProductId(loyaltyProductIdSub);\n\t\t\t\t\tif (newProductDTO != null) {\n\t\t\t\t\t\tlong newProductId = newProductDTO.getId();\n\t\t\t\t\t\tString newBrandName = newProductDTO.getBrand().getName();\n\t\t\t\t\t\tString newProductName = """";\n\t\t\t\t\t\tif(getCurrentLanguage().equals(WebConstants.ENGLISH_LANGUAGE)) {\t\t\t\t\t\n\t\t\t\t\t\t\tnewProductName = newProductDTO.getNameEng().getName();\t\t\t\t\t\n\t\t\t\t\t\t} else if(getCurrentLanguage().equals(WebConstants.FRENCH_LANGUAGE)) {\n\t\t\t\t\t\t\tnewProductName = newProductDTO.getNameFr().getName();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnewLSProductIdSubHRef = SeoUrlsMaker.getProductUrl(newBrandName, newProductName, newProductId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tweight = productDTO.getWeight();\t\t\n\t\t\tif (weight != null) {\n\t\t\t\tweight = (!weight.matches(""^\\\\s*$"")) ? String.valueOf(weight) : """";\t\n\t\t\t} else {\n\t\t\t\tweight = """";\n\t\t\t}\n\t\t\t\n\t\t\tString width = productDTO.getWidth();\tw = (!width.equalsIgnoreCase(""0"")) ? String.valueOf(width) : """";\n\t\t\tString large = productDTO.getLarge();\tl = (!large.equalsIgnoreCase(""0"")) ? String.valueOf(large) : """";\t\n\t\t\tString high = productDTO.getHigh();\t\th = (!high.equalsIgnoreCase(""0""))  ? String.valueOf(high)  : """";\n\t\t\t\n\t\t\tif(productDTO.getManufactureProductList().size() >= 1) {\n\t\t\t\tmodelNumber= ((ProductModelDTO)productDTO.getManufactureProductList().get(0)).getName();\n\t\t\t} else {\n\t\t\t\tmodelNumber = """";\n\t\t\t}\n\t\t\tmodelNumber = ((ProductModelDTO)productDTO.getManufactureProductList().get(0)).getName();\t\t\t\n\t\t\t\n\t\t\tif (userSessionDTO != null) {\n\t\t\t\tList<UserProductPriceDTO> userProductPriceDTOList = productService.getUserProductPriceList(productId);\n\t\t\t\tfor (UserProductPriceDTO userProductPriceDTO : userProductPriceDTOList) {\n\t\t\t\t\tif (userSessionDTO.getId() == userProductPriceDTO.getUserId() && userProductPriceDTO.getExcluded()) {\n\t\t\t\t\t\tsendRestricted = ""restricted"";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t/*numberOfProductModelElements = (productDTO.getManufactureProductList() != null) \n\t\t\t\t\t\t\t\t\t\t\t? productDTO.getManufactureProductList().size()\n\t\t\t\t\t\t\t\t\t\t\t: 0;*/\n\t\t\tnumberOfProductModelElements=productService.isGroupProductID(productId);\n\t\t\tprice = productDTO.getPriceProduct();\n\t\t\tmsrp = productDTO.getMsrp();\n\t\t\tpercentage = """";\n\t\t\tdiscount = """";\n\t\t\t\n\t\t\tdouble priceVal = 0d;\n\t\t\tdouble msrpVal = 0d;\n\t\t\tdouble discountVal = 0d;\n\t\t\tdouble percentageVal = 0d;\n\t\t\t\n\t\t\tif (userSessionDTO != null) {\t// User logged in!!!\t\t\t\t\n\t\t\t\tif (price != null) {\n\t\t\t\t\tif (!price.matches(""^\\\\s*$"") && !price.equalsIgnoreCase("""")) {\t\t\t\t\t\n\t\t\t\t\t\tpriceVal = Double.parseDouble(price);\n\t\t\t\t\t\tprice = ""$"" + format(priceVal, ""#,###.00"", ""en"", ""US"");\t\t\t\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpriceVal = 0d;\n\t\t\t\t\t\tprice = """";\n\t\t\t\t\t}\n\t\t\t\t}\t\t\t\t\n\t\t\t\tif (msrp != null) {\t\t\t\t\t\n\t\t\t\t\tif (!msrp.matches(""^\\\\s*$"") && !msrp.equalsIgnoreCase("""")) {\t\n\t\t\t\t\t\tmsrpVal = Double.parseDouble(msrp);\n\t\t\t\t\t\tmsrp = ""$"" + format(msrpVal, ""#,###.00"", ""en"", ""US"");\t\n\t\t\t\t\t\tdiscountVal = msrpVal - priceVal;\n\t\t\t\t\t\tdiscount = (discountVal != 0d) ? (""$"" + format(discountVal, ""#,###.00"", ""en"", ""US"")) : """";\t\t\t\t\t\n\t\t\t\t\t\tpercentageVal = (msrpVal != 0d) ? (100d * discountVal / msrpVal) : 0d;\n\t\t\t\t\t\tpercentage = (percentageVal != 0d) \n\t\t\t\t\t\t\t\t\t\t? ""("" + format(percentageVal, ""0.00"", ""en"", ""CA"") + ""%)"" \n\t\t\t\t\t\t\t\t\t\t: """" ;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdiscount = """";\n\t\t\t\t\t\tpercentage = """";\n\t\t\t\t\t\tmsrp = """";\n\t\t\t\t\t}\t\t\t\n\t\t\t\t}\t\t\t\n\t\t\t\tloyaltyProductId = concatenate(userSessionDTO.getCode(), productDTO.getLoyaltyProductId());\t\n\t\t\t} else {\t// User Not Logged-in!!!!\n\t\t\t\tif (msrp != null || !msrp.matches(""^\\\\s*$"")) {\n\t\t\t\t\tmsrpVal = Double.parseDouble(msrp);\n\t\t\t\t\tmsrp = ""$"" + format(msrpVal, ""#,###.00"", ""en"", ""US"");\n\t\t\t\t} else {\n\t\t\t\t\tmsrp = """";\t\t\n\t\t\t\t}\n\t\t\t\tloyaltyProductId = productDTO.getLoyaltyProductId();\n\t\t\t}\n\t\t\tloyaltyProductIdWithountPrefix=productDTO.getLoyaltyProductId();\n\t\t\tlong groupId = productDTO.getCategory().getCategoryGoupeId();\n\t\t\tgroupName = groupId >= 1L \n\t\t\t\t\t\t? GroupCategoryEnum.values()[((int) groupId) - 1].getCode() \n\t\t\t\t\t\t: """";\n\t\t\tgroupHL = SeoUrlsMaker.getCategoryGroupUrl(groupName);\n\t\t\tlong categoryID = productDTO.getCategory().getId();\n\t\t\tcategoryName = productDTO.getCategory().getName();\n\t\t\tcategoryHL = SeoUrlsMaker.getCategoryUrl(groupName, categoryName, categoryID);\n\t\t\tlong specId = productDTO.getMainFilterTypeId();\n\t\t\tSpecificationDTO specDTO = specificationService.getSpecification(specId);\t\t\t\n\t\t\t\n\t\t\tspecName = specDTO.getName();\n\t\t\tspecHL = SeoUrlsMaker.getSpecificationUrl(groupName, categoryName, specName, specId);\n\t\t\t\n\t\t\trequest.getSession(true).setAttribute(""queryID"", groupId);\t\t\t\n\t\t\trequest.getSession(true).setAttribute(""productBreadcrumb"", productBreadcrumb);\n\t\t\trequest.getSession(true).setAttribute(""groupName"", groupName);\n\t\t\trequest.getSession(true).setAttribute(""groupHL"", groupHL);\n\t\t\trequest.getSession(true).setAttribute(""categoryName"", categoryName);\n\t\t\trequest.getSession(true).setAttribute(""categoryHL"", categoryHL);\n\t\t\trequest.getSession(true).setAttribute(""specName"", specName);\n\t\t\trequest.getSession(true).setAttribute(""specHL"", specHL);\n\t\t\t\n\t\t\t//Set information title\n\t\t\trequest.setAttribute(RequestAtributeConstants.PAGE_TITLE_PARAM_1, productName);\n\t\t\trequest.setAttribute(RequestAtributeConstants.PAGE_TITLE_PARAM_2, brandDTO.getName());\n\t\t\t\n\t\t\t\n\t\t\tif (userSessionDTO != null) {\n\t\t\t\tlong userId = userSessionDTO.getId();\n\t\t\t\tprovinceNameList = productService.getShippingTotalList(productId, userId);\n\t\t\t\tfinal int SIZE = provinceNameList.size();\n\t\t\t\tprovinceName = new String[SIZE];\n\t\t\t\tshippingCost = new String[SIZE];\t\n\t\t\t\t\n\t\t\t\tProvinceDTO provinceDTO = new ProvinceDTO();\n\t\t\t\tlong provinceId = 0L;\n\t\t\t\tint count = 0;\n\t\t\t\tString $ = ""$"";\n\t\t\t\tfor (ShippingTotalDTO shippingTotalDTO : provinceNameList) {\n\t\t\t\t\tprovinceId = shippingTotalDTO.getProvinceId();\n\t\t\t\t\tprovinceDTO = productService.getProvince(provinceId);\n\t\t\t\t\tprovinceName[count] = provinceDTO.getCode();\n\t\t\t\t\tif (!shippingTotalDTO.getAverageShippingTotal().trim()\n\t\t\t\t\t\t\t.equalsIgnoreCase(""NOT AVAILABLE"")) {\n\t\t\t\t\t\tshippingCost[count] = $ + shippingTotalDTO.getAverageShippingTotal();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tshippingCost[count] = ""N/A"";\n\t\t\t\t\t}\n\t\t\t\t\t++count;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tUserProductPriceDTO userProductPriceDTO = productService.getUserProductPriceInformation(productId, userId);\n\t\t\t\t\n\t\t\t\tshippingTotalCanada = userProductPriceDTO.getShippingTotalCanada();\n\t\t\t\tdouble shippingCanada = 0d;\n\t\t\t\tif (shippingTotalCanada != null || !shippingTotalCanada.matches(""^\\\\s*$"")) {\n\t\t\t\t\tshippingCanada = Double.parseDouble(shippingTotalCanada);\n\t\t\t\t\tshippingTotalCanada = ""$"" + format(shippingCanada, ""#,###.00"", ""en"", ""US"");\n\t\t\t\t} else {\n\t\t\t\t\tshippingTotalCanada = """";\n\t\t\t\t}\n\t\t\t}\t\t\t\n\t\t\t\n\t\t} catch(ServiceException e) {\n\t\t\tlog.debug(""Service Error when loading file"");\n\t\t\taddActionError(getText(""loyauty.error.common.service""));\n\t\t} catch (Exception e) {\n\t\t\taddActionError(getText(""loyauty.error.common.service""));\n\t\t}\t\t\n\t\treturn SUCCESS;\n\t}\n\t\n\tprivate String format(double value, String pattern, String language, String country) {\n\t\tLocale loc = new Locale(language, country);\n\t\tNumberFormat nf = NumberFormat.getInstance(loc);\n\t\tDecimalFormat df = (DecimalFormat) nf;\n\t\tdf.applyPattern(pattern);\n\t\treturn nf.format(value);\n\t}\n\t\n\tprivate int countBackRepeatsFromLast(String inputLeft) {\n\t\tint numberOfRepeats = 0;\n\t\tint pointer = inputLeft.length() - 1;\n\t\twhile (inputLeft.charAt(pointer) == CHAR_PATTERN_THAT_REPEATS) {\n\t\t\tif (inputLeft.charAt(pointer) == CHAR_PATTERN_THAT_REPEATS) ++numberOfRepeats;\n\t\t\tif (pointer == 0) break;\n\t\t\t-- pointer;\n\t\t}\n\t\treturn numberOfRepeats;\n\t}\n\t\n\tprivate int countForthRepeatsFromFirst(String inputRight) {\n\t\tint numberOfRepeats = 0;\n\t\tint pointer = 0;\n\t\twhile (inputRight.charAt(pointer) == CHAR_PATTERN_THAT_REPEATS) {\n\t\t\tif (inputRight.charAt(pointer) == CHAR_PATTERN_THAT_REPEATS) ++numberOfRepeats;\n\t\t\tif (pointer == inputRight.length() - 1) break;\n\t\t\t++pointer;\n\t\t}\n\t\treturn numberOfRepeats;\n\t}\n\t\n\tprivate boolean areThereRepeatsBackLeft(String inputLeft) {\n\t\treturn (countBackRepeatsFromLast(inputLeft) > 0);\n\t}\n\t\n\tprivate boolean areThereRepeatsForthRight(String inputRight) {\n\t\treturn (countForthRepeatsFromFirst(inputRight) > 0);\n\t}\n\t\n\tprivate String concatenate(String inputLeft, String inputRight) {\n\t\tString l = """", union = """", r = """";\n\t\tString leftChar = """", rightChar = """";\n\t\t\n\t\tif (inputLeft.equalsIgnoreCase("""") && inputRight.equalsIgnoreCase("""")) {\n\t\t\treturn """";\n\t\t}\n\t\t\n\t\tif (areThereRepeatsBackLeft(inputLeft)) {\n\t\t\tif (countBackRepeatsFromLast(inputLeft) == inputLeft.length()) {\n\t\t\t\tinputLeft = UNION;\n\t\t\t} else {\t// countBackRepeatsFromLast(inputLeft) < inputLeft.length()\n\t\t\t\tint info = inputLeft.length() - countBackRepeatsFromLast(inputLeft);\n\t\t\t\tinputLeft = inputLeft.substring(0, info + 1);\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (areThereRepeatsForthRight(inputRight)) {\n\t\t\tif (countForthRepeatsFromFirst(inputRight) == inputRight.length()) {\n\t\t\t\tinputRight = UNION;\n\t\t\t} else {\t// countForthRepeatsFromFirst(inputRight) < inputRight.length()\n\t\t\t\tinputRight = inputRight.substring(countForthRepeatsFromFirst(inputRight) - 1, inputRight.length());\n\t\t\t}\n\t\t}\n\t\t\n\t\tleftChar = (inputLeft.length() > 0) ? inputLeft.substring(inputLeft.length() - 1) : """";\n\t\trightChar = (inputRight.length() > 0) ? inputRight.substring(0, 1) : """";\n\t\tif (inputLeft.length() > 0 && inputRight.length() > 0) {\t\t\t\n\t\t\tunion = UNION;\n\t\t\tif (leftChar.equalsIgnoreCase(UNION) && !rightChar.equalsIgnoreCase(UNION)) {\n\t\t\t\tl = inputLeft.substring(0, inputLeft.length() - 1);\n\t\t\t\tr = inputRight;\n\t\t\t} else if (!leftChar.equalsIgnoreCase(UNION) && rightChar.equalsIgnoreCase(UNION)) {\n\t\t\t\tl = inputLeft;\n\t\t\t\tr = inputRight.substring(1, inputRight.length());\n\t\t\t} else if (leftChar.equalsIgnoreCase(UNION) && rightChar.equalsIgnoreCase(UNION)) {\n\t\t\t\tl = inputLeft.substring(0, inputLeft.length() - 1);\n\t\t\t\tr = inputRight.substring(1, inputRight.length());\t\n\t\t\t} else {\n\t\t\t\tl = inputLeft;\n\t\t\t\tr = inputRight;\n\t\t\t}\t\t\t\n\t\t} else if (inputLeft.length() == 0 && inputRight.length() > 0) {\n\t\t\tl = """";\n\t\t\tunion = """";\n\t\t\tr = inputRight;\t\t\t\t\n\t\t} else if (inputLeft.length() > 0 && inputRight.length() == 0) {\n\t\t\tl = inputLeft;\n\t\t\tunion = """";\n\t\t\tr = """";\t\t\t\t\n\t\t} else if (inputLeft.length() == 0 && inputRight.length() == 0) {\n\t\t\t\tl = union = r = """";\n\t\t}\n\t\treturn (l + union + r);\n\t}\n\t\t\n}\n\n----------------------------------- SOURCE END -------------------------------------",1403192928039
error,log,,,"Problems occurred when invoking code from plug-in: ""org.eclipse.jdt.ui"".",1403192928039
error,log,,,"Error in JDT Core during reconcile",1403192928039
activated,view,org.eclipse.ui.console,3.5.0.v20100526,"org.eclipse.ui.console.ConsoleView",1403192929568
error,log,,,"Exception occurred during problem detection:\n----------------------------------- SOURCE BEGIN -------------------------------------\npackage com.loyauty.web.struts.action.product;\n\nimport java.text.DecimalFormat;\nimport java.text.NumberFormat;\nimport java.util.Locale;\nimport java.util.List;\n\nimport lombok.Getter;\nimport lombok.Setter;\n\nimport com.loyauty.enums.GroupCategoryEnum;\nimport com.loyauty.enums.ProductStatus;\nimport com.loyauty.enums.UserType;\nimport com.loyauty.exception.ServiceException;\nimport com.loyauty.exception.ServiceLocatorException;\nimport com.loyauty.model.UserProductPrice;\nimport com.loyauty.service.core.dto.ImageDTO;\nimport com.loyauty.service.core.dto.BrandDTO;\nimport com.loyauty.service.core.dto.ProductDTO;\nimport com.loyauty.service.core.dto.ProvinceDTO;\nimport com.loyauty.service.core.dto.ShippingTotalDTO;\nimport com.loyauty.service.core.dto.ProductModelDTO;\nimport com.loyauty.service.core.dto.SpecificationDTO;\nimport com.loyauty.service.core.dto.UserProductPriceDTO;\nimport com.loyauty.service.core.dto.UserSessionDTO;\nimport com.loyauty.service.orders.OrdersService;\nimport com.loyauty.service.product.ProductService;\nimport com.loyauty.service.specification.SpecificationService;\nimport com.loyauty.web.RequestAtributeConstants;\nimport com.loyauty.web.WebConstants;\nimport com.loyauty.web.struts.action.LoyautyAction;\nimport com.loyauty.web.util.SeoUrlsMaker;\n\npublic class Product extends LoyautyAction {\n\t\n\tprivate static final long serialVersionUID = 1L;\n\t\n\tprivate static final String UNION = ""_"";\n\tprivate static final char CHAR_PATTERN_THAT_REPEATS = '_';\n\t\n\tprivate ProductService productService;\n\tprivate SpecificationService specificationService;\n\t\n\t@Getter @Setter\n\tprivate ProductDTO productDTO;\n\t@Getter @Setter\n\tprivate BrandDTO brandDTO;\n\t@Getter @Setter\n\tprivate ImageDTO productImageDTO;\n\t@Getter @Setter\n\tprivate ImageDTO brandImageDTO;\n\t@Getter @Setter\n\tprivate String productImageName;\n\t@Getter @Setter\n\tprivate String brandImageName;\n\t@Getter @Setter\n\tprivate long productId;\n\t@Getter @Setter\n\tprivate String productName;\n\t@Getter @Setter\n\tprivate String desc;\t\n\t@Getter @Setter\n\tprivate String spec;\n\t@Getter @Setter\n\tprivate String other;\n\t@Getter @Setter\n\tprivate String loyaltyProductId;\n\t@Getter @Setter\n\tprivate String loyaltyProductIdWithountPrefix;\n\t@Getter @Setter\n\tprivate String weight;\n\t@Getter @Setter\n\tprivate String w;\n\t@Getter @Setter\n\tprivate String l;\n\t@Getter @Setter\n\tprivate String h;\t\n\t@Getter @Setter\n\tprivate String modelNumber;\n\t@Getter @Setter\n\tprivate String price;\t\n\t@Getter @Setter\n\tprivate String msrp;\n\t@Getter @Setter\n\tprivate String discount;\n\t@Getter @Setter\n\tprivate String percentage;\t\n\t@Getter @Setter\n\tprivate String productBreadcrumb;\n\t@Getter @Setter\n\tprivate String groupName;\n\t@Getter @Setter\n\tprivate String groupHL;\n\t@Getter @Setter\n\tprivate String categoryName;\n\t@Getter @Setter\n\tprivate String categoryHL;\n\t@Getter @Setter\n\tprivate String specName;\n\t@Getter @Setter\n\tprivate String specHL;\t\n\t@Getter @Setter\n\tprivate String warranty;\t\n\t@Getter @Setter\n\tprivate String hrefName;\n\t@Getter @Setter\n\tprivate String link;\n\t@Getter @Setter\n\tprivate String warning;\n\t@Getter @Setter\n\tprivate String warning2;\t\n\t@Getter @Setter\n\tprivate String writeWarning;\n\t@Getter @Setter\n\tprivate String loyaltyProductIdSub;\n\t@Getter @Setter\n\tprivate String newLSProductIdSubHRef;\n\t\n\t@Getter @Setter\n\tprivate String sendRestricted;\n\t\n\t@Getter @Setter\n\tprivate Long numberOfProductModelElements;\n\t\n\t@Getter @Setter\n\tprivate List<ShippingTotalDTO> provinceNameList;\n\t@Getter @Setter\n\tprivate String[] provinceName;\t\n\t@Getter @Setter\n\tString[] shippingCost;\n\t@Getter @Setter\n\tprivate String shippingTotalCanada;\n\t\n\tpublic Product() throws ServiceLocatorException {\n\t\tsuper();\n\t\tproductService = getServiceLocator().getProductService();\t\n\t\tspecificationService = getServiceLocator().getSpecificationService();\n\t}\t\n\t\n\t@Override  \n\tpublic String execute() throws Exception {\n\t\ttry {\n\t\t\tUserSessionDTO userSessionDTO = (UserSessionDTO)request.getSession().getAttribute(WebConstants.USER);\n\t\t\t\n\t\t\tif (userSessionDTO != null) {\n\t\t\t\tproductDTO = productService.getProductInformation(productId, userSessionDTO.getId());\n\t\t\t\tproductBreadcrumb = ""Our Products"";\t\t\t\t\n\t\t\t} else {\n\t\t\t\tproductDTO = productService.getProductInformation(productId, null);\n\t\t\t\tproductBreadcrumb = ""Products"";\n\t\t\t}\n\t\t\t\n\t\t\tproductImageDTO = productDTO.getImage();\n\t\t\tproductImageName = productImageDTO != null ? productImageDTO.getName() : """";\n\t\t\t\n\t\t\tif (productDTO.getBrand() != null) {\n\t\t\t\tbrandDTO = productDTO.getBrand();\n\t\t\t\t\n\t\t\t\tproductDTO.getBrand().setHrefName(SeoUrlsMaker.getBrandUrl(brandDTO.getName(), brandDTO.getId()));\n\t\t\t\t\n\t\t\t\tif (brandDTO.getImage() != null) {\n\t\t\t\t\tbrandImageDTO = brandDTO.getImage();\n\t\t\t\t\tif (brandImageDTO != null) {\n\t\t\t\t\t\tbrandImageName = brandImageDTO.getName();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbrandImageName = """";\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tbrandImageName = """";\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tbrandImageName = """";\n\t\t\t}\n\t\t\t\n\t\t\tif (getCurrentLanguage().equals(WebConstants.ENGLISH_LANGUAGE)) {\n\t\t\t\tproductName = productDTO.getNameEng().getName();\n\t\t\t\tdesc = productDTO.getDescriptionEng().getName();\n\t\t\t\tspec = productDTO.getSpecificationEng().getName();\n\t\t\t\tother = productDTO.getOtherEng().getName();\n\t\t\t\twarranty = (productDTO.getWarrantyEng() != null) ? productDTO.getWarrantyEng().getName() : """";\n\t\t\t} else if (getCurrentLanguage().equals(WebConstants.FRENCH_LANGUAGE)) { \n\t\t\t\tproductName = productDTO.getNameFr().getName();\n\t\t\t\tdesc = productDTO.getDescriptionFr().getName();\n\t\t\t\tspec = productDTO.getSpecificationFr().getName();\n\t\t\t\tother = productDTO.getSpecificationFr().getName();\n\t\t\t\twarranty = (productDTO.getWarrantyFr() != null) ? productDTO.getWarrantyFr().getName() : """";\n\t\t\t}\n\t\t\t\n\t\t\t//Link url \n\t\t\tif(productDTO.getLinkList().size() > 0)\n\t\t\t\tlink = productDTO.getLinkList().get(0).getLink();\n\n\t\t\tif (desc.indexOf(""<p></p>"") != -1 && desc.length() == 7) desc = desc.replaceAll(""<p></p>"", """");\n\t\t\tif (spec.indexOf(""<p></p>"") != -1 && spec.length() == 7) spec = spec.replaceAll(""<p></p>"", """");\n\t\t\t\n\t\t\tInteger status = productDTO.getStatus().getValue();\n\t\t\tif (status == ProductStatus.UNAVAILABLE.getValue()) {\n\t\t\t\twriteWarning = ""y2"";\n\t\t\t\twarning = ""PRODUCT TEMPORARILY UNAVAILABLE"";\n\t\t\t} else if (status == ProductStatus.DISCONTINUED.getValue()) {\n\t\t\t\twriteWarning = ""y3"";\n\t\t\t\tloyaltyProductIdSub = productDTO.getLoyaltyProductIdSub();\n\t\t\t\twarning = ""THIS PRODUCT IS DISCONTINUED"";\n\t\t\t\t\n\t\t\t\tif (!loyaltyProductIdSub.matches(""^\\\\s*$"")) {\n\t\t\t\t\twarning2 = ""Please view our suggested replacement: "";\n\t\t\t\t\tProductDTO newProductDTO = productService.getProductIdFromLSProductId(loyaltyProductIdSub);\n\t\t\t\t\tif (newProductDTO != null) {\n\t\t\t\t\t\tlong newProductId = newProductDTO.getId();\n\t\t\t\t\t\tString newBrandName = newProductDTO.getBrand().getName();\n\t\t\t\t\t\tString newProductName = """";\n\t\t\t\t\t\tif(getCurrentLanguage().equals(WebConstants.ENGLISH_LANGUAGE)) {\t\t\t\t\t\n\t\t\t\t\t\t\tnewProductName = newProductDTO.getNameEng().getName();\t\t\t\t\t\n\t\t\t\t\t\t} else if(getCurrentLanguage().equals(WebConstants.FRENCH_LANGUAGE)) {\n\t\t\t\t\t\t\tnewProductName = newProductDTO.getNameFr().getName();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnewLSProductIdSubHRef = SeoUrlsMaker.getProductUrl(newBrandName, newProductName, newProductId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tweight = productDTO.getWeight();\t\t\n\t\t\tif (weight != null) {\n\t\t\t\tweight = (!weight.matches(""^\\\\s*$"")) ? String.valueOf(weight) : """";\t\n\t\t\t} else {\n\t\t\t\tweight = """";\n\t\t\t}\n\t\t\t\n\t\t\tString width = productDTO.getWidth();\tw = (!width.equalsIgnoreCase(""0"")) ? String.valueOf(width) : """";\n\t\t\tString large = productDTO.getLarge();\tl = (!large.equalsIgnoreCase(""0"")) ? String.valueOf(large) : """";\t\n\t\t\tString high = productDTO.getHigh();\t\th = (!high.equalsIgnoreCase(""0""))  ? String.valueOf(high)  : """";\n\t\t\t\n\t\t\tif(productDTO.getManufactureProductList().size() >= 1) {\n\t\t\t\tmodelNumber= ((ProductModelDTO)productDTO.getManufactureProductList().get(0)).getName();\n\t\t\t} else {\n\t\t\t\tmodelNumber = """";\n\t\t\t}\n\t\t\tmodelNumber = ((ProductModelDTO)productDTO.getManufactureProductList().get(0)).getName();\t\t\t\n\t\t\t\n\t\t\tif (userSessionDTO != null) {\n\t\t\t\tList<UserProductPriceDTO> userProductPriceDTOList = productService.getUserProductPriceList(productId);\n\t\t\t\tfor (UserProductPriceDTO userProductPriceDTO : userProductPriceDTOList) {\n\t\t\t\t\tif (userSessionDTO.getId() == userProductPriceDTO.getUserId() && userProductPriceDTO.getExcluded()) {\n\t\t\t\t\t\tsendRestricted = ""restricted"";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t/*numberOfProductModelElements = (productDTO.getManufactureProductList() != null) \n\t\t\t\t\t\t\t\t\t\t\t? productDTO.getManufactureProductList().size()\n\t\t\t\t\t\t\t\t\t\t\t: 0;*/\n\t\t\tnumberOfProductModelElements=productService.isGroupProductID(productId);\n\t\t\tprice = productDTO.getPriceProduct();\n\t\t\tmsrp = productDTO.getMsrp();\n\t\t\tpercentage = """";\n\t\t\tdiscount = """";\n\t\t\t\n\t\t\tdouble priceVal = 0d;\n\t\t\tdouble msrpVal = 0d;\n\t\t\tdouble discountVal = 0d;\n\t\t\tdouble percentageVal = 0d;\n\t\t\t\n\t\t\tif (userSessionDTO != null) {\t// User logged in!!!\t\t\t\t\n\t\t\t\tif (price != null) {\n\t\t\t\t\tif (!price.matches(""^\\\\s*$"") && !price.equalsIgnoreCase("""")) {\t\t\t\t\t\n\t\t\t\t\t\tpriceVal = Double.parseDouble(price);\n\t\t\t\t\t\tprice = ""$"" + format(priceVal, ""#,###.00"", ""en"", ""US"");\t\t\t\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpriceVal = 0d;\n\t\t\t\t\t\tprice = """";\n\t\t\t\t\t}\n\t\t\t\t}\t\t\t\t\n\t\t\t\tif (msrp != null) {\t\t\t\t\t\n\t\t\t\t\tif (!msrp.matches(""^\\\\s*$"") && !msrp.equalsIgnoreCase("""")) {\t\n\t\t\t\t\t\tmsrpVal = Double.parseDouble(msrp);\n\t\t\t\t\t\tmsrp = ""$"" + format(msrpVal, ""#,###.00"", ""en"", ""US"");\t\n\t\t\t\t\t\tdiscountVal = msrpVal - priceVal;\n\t\t\t\t\t\tdiscount = (discountVal != 0d) ? (""$"" + format(discountVal, ""#,###.00"", ""en"", ""US"")) : """";\t\t\t\t\t\n\t\t\t\t\t\tpercentageVal = (msrpVal != 0d) ? (100d * discountVal / msrpVal) : 0d;\n\t\t\t\t\t\tpercentage = (percentageVal != 0d) \n\t\t\t\t\t\t\t\t\t\t? ""("" + format(percentageVal, ""0.00"", ""en"", ""CA"") + ""%)"" \n\t\t\t\t\t\t\t\t\t\t: """" ;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdiscount = """";\n\t\t\t\t\t\tpercentage = """";\n\t\t\t\t\t\tmsrp = """";\n\t\t\t\t\t}\t\t\t\n\t\t\t\t}\t\t\t\n\t\t\t\tloyaltyProductId = concatenate(userSessionDTO.getCode(), productDTO.getLoyaltyProductId());\t\n\t\t\t} else {\t// User Not Logged-in!!!!\n\t\t\t\tif (msrp != null || !msrp.matches(""^\\\\s*$"")) {\n\t\t\t\t\tmsrpVal = Double.parseDouble(msrp);\n\t\t\t\t\tmsrp = ""$"" + format(msrpVal, ""#,###.00"", ""en"", ""US"");\n\t\t\t\t} else {\n\t\t\t\t\tmsrp = """";\t\t\n\t\t\t\t}\n\t\t\t\tloyaltyProductId = productDTO.getLoyaltyProductId();\n\t\t\t}\n\t\t\tloyaltyProductIdWithountPrefix=productDTO.getLoyaltyProductId();\n\t\t\tlong groupId = productDTO.getCategory().getCategoryGoupeId();\n\t\t\tgroupName = groupId >= 1L \n\t\t\t\t\t\t? GroupCategoryEnum.values()[((int) groupId) - 1].getCode() \n\t\t\t\t\t\t: """";\n\t\t\tgroupHL = SeoUrlsMaker.getCategoryGroupUrl(groupName);\n\t\t\tlong categoryID = productDTO.getCategory().getId();\n\t\t\tcategoryName = productDTO.getCategory().getName();\n\t\t\tcategoryHL = SeoUrlsMaker.getCategoryUrl(groupName, categoryName, categoryID);\n\t\t\tlong specId = productDTO.getMainFilterTypeId();\n\t\t\tSpecificationDTO specDTO = specificationService.getSpecification(specId);\t\t\t\n\t\t\t\n\t\t\tspecName = specDTO.getName();\n\t\t\tspecHL = SeoUrlsMaker.getSpecificationUrl(groupName, categoryName, specName, specId);\n\t\t\t\n\t\t\trequest.getSession(true).setAttribute(""queryID"", groupId);\t\t\t\n\t\t\trequest.getSession(true).setAttribute(""productBreadcrumb"", productBreadcrumb);\n\t\t\trequest.getSession(true).setAttribute(""groupName"", groupName);\n\t\t\trequest.getSession(true).setAttribute(""groupHL"", groupHL);\n\t\t\trequest.getSession(true).setAttribute(""categoryName"", categoryName);\n\t\t\trequest.getSession(true).setAttribute(""categoryHL"", categoryHL);\n\t\t\trequest.getSession(true).setAttribute(""specName"", specName);\n\t\t\trequest.getSession(true).setAttribute(""specHL"", specHL);\n\t\t\t\n\t\t\t//Set information title\n\t\t\trequest.setAttribute(RequestAtributeConstants.PAGE_TITLE_PARAM_1, productName);\n\t\t\trequest.setAttribute(RequestAtributeConstants.PAGE_TITLE_PARAM_2, brandDTO.getName());\n\t\t\t\n\t\t\t\n\t\t\tif (userSessionDTO != null) {\n\t\t\t\tlong userId = userSessionDTO.getId();\n\t\t\t\tprovinceNameList = productService.getShippingTotalList(productId, userId);\n\t\t\t\tfinal int SIZE = provinceNameList.size();\n\t\t\t\tprovinceName = new String[SIZE];\n\t\t\t\tshippingCost = new String[SIZE];\t\n\t\t\t\t\n\t\t\t\tProvinceDTO provinceDTO = new ProvinceDTO();\n\t\t\t\tlong provinceId = 0L;\n\t\t\t\tint count = 0;\n\t\t\t\tString $ = ""$"";\n\t\t\t\tfor (ShippingTotalDTO shippingTotalDTO : provinceNameList) {\n\t\t\t\t\tprovinceId = shippingTotalDTO.getProvinceId();\n\t\t\t\t\tprovinceDTO = productService.getProvince(provinceId);\n\t\t\t\t\tprovinceName[count] = provinceDTO.getCode();\n\t\t\t\t\tif (!shippingTotalDTO.getAverageShippingTotal().trim()\n\t\t\t\t\t\t\t.equalsIgnoreCase(""NOT AVAILABLE"")) {\n\t\t\t\t\t\tshippingCost[count] = $ + shippingTotalDTO.getAverageShippingTotal();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tshippingCost[count] = ""N/A"";\n\t\t\t\t\t}\n\t\t\t\t\t++count;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tUserProductPriceDTO userProductPriceDTO = productService.getUserProductPriceInformation(productId, userId);\n\t\t\t\t\n\t\t\t\tshippingTotalCanada = userProductPriceDTO.getShippingTotalCanada();\n\t\t\t\tdouble shippingCanada = 0d;\n\t\t\t\tif (shippingTotalCanada != null || !shippingTotalCanada.matches(""^\\\\s*$"")) {\n\t\t\t\t\tshippingCanada = Double.parseDouble(shippingTotalCanada);\n\t\t\t\t\tshippingTotalCanada = ""$"" + format(shippingCanada, ""#,###.00"", ""en"", ""US"");\n\t\t\t\t} else {\n\t\t\t\t\tshippingTotalCanada = """";\n\t\t\t\t}\n\t\t\t}\t\t\t\n\t\t\t\n\t\t} catch(ServiceException e) {\n\t\t\tlog.debug(""Service Error when loading file"");\n\t\t\taddActionError(getText(""loyauty.error.common.service""));\n\t\t} catch (Exception e) {\n\t\t\taddActionError(getText(""loyauty.error.common.service""));\n\t\t}\t\t\n\t\treturn SUCCESS;\n\t}\n\t\n\tprivate String format(double value, String pattern, String language, String country) {\n\t\tLocale loc = new Locale(language, country);\n\t\tNumberFormat nf = NumberFormat.getInstance(loc);\n\t\tDecimalFormat df = (DecimalFormat) nf;\n\t\tdf.applyPattern(pattern);\n\t\treturn nf.format(value);\n\t}\n\t\n\tprivate int countBackRepeatsFromLast(String inputLeft) {\n\t\tint numberOfRepeats = 0;\n\t\tint pointer = inputLeft.length() - 1;\n\t\twhile (inputLeft.charAt(pointer) == CHAR_PATTERN_THAT_REPEATS) {\n\t\t\tif (inputLeft.charAt(pointer) == CHAR_PATTERN_THAT_REPEATS) ++numberOfRepeats;\n\t\t\tif (pointer == 0) break;\n\t\t\t-- pointer;\n\t\t}\n\t\treturn numberOfRepeats;\n\t}\n\t\n\tprivate int countForthRepeatsFromFirst(String inputRight) {\n\t\tint numberOfRepeats = 0;\n\t\tint pointer = 0;\n\t\twhile (inputRight.charAt(pointer) == CHAR_PATTERN_THAT_REPEATS) {\n\t\t\tif (inputRight.charAt(pointer) == CHAR_PATTERN_THAT_REPEATS) ++numberOfRepeats;\n\t\t\tif (pointer == inputRight.length() - 1) break;\n\t\t\t++pointer;\n\t\t}\n\t\treturn numberOfRepeats;\n\t}\n\t\n\tprivate boolean areThereRepeatsBackLeft(String inputLeft) {\n\t\treturn (countBackRepeatsFromLast(inputLeft) > 0);\n\t}\n\t\n\tprivate boolean areThereRepeatsForthRight(String inputRight) {\n\t\treturn (countForthRepeatsFromFirst(inputRight) > 0);\n\t}\n\t\n\tprivate String concatenate(String inputLeft, String inputRight) {\n\t\tString l = """", union = """", r = """";\n\t\tString leftChar = """", rightChar = """";\n\t\t\n\t\tif (inputLeft.equalsIgnoreCase("""") && inputRight.equalsIgnoreCase("""")) {\n\t\t\treturn """";\n\t\t}\n\t\t\n\t\tif (areThereRepeatsBackLeft(inputLeft)) {\n\t\t\tif (countBackRepeatsFromLast(inputLeft) == inputLeft.length()) {\n\t\t\t\tinputLeft = UNION;\n\t\t\t} else {\t// countBackRepeatsFromLast(inputLeft) < inputLeft.length()\n\t\t\t\tint info = inputLeft.length() - countBackRepeatsFromLast(inputLeft);\n\t\t\t\tinputLeft = inputLeft.substring(0, info + 1);\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (areThereRepeatsForthRight(inputRight)) {\n\t\t\tif (countForthRepeatsFromFirst(inputRight) == inputRight.length()) {\n\t\t\t\tinputRight = UNION;\n\t\t\t} else {\t// countForthRepeatsFromFirst(inputRight) < inputRight.length()\n\t\t\t\tinputRight = inputRight.substring(countForthRepeatsFromFirst(inputRight) - 1, inputRight.length());\n\t\t\t}\n\t\t}\n\t\t\n\t\tleftChar = (inputLeft.length() > 0) ? inputLeft.substring(inputLeft.length() - 1) : """";\n\t\trightChar = (inputRight.length() > 0) ? inputRight.substring(0, 1) : """";\n\t\tif (inputLeft.length() > 0 && inputRight.length() > 0) {\t\t\t\n\t\t\tunion = UNION;\n\t\t\tif (leftChar.equalsIgnoreCase(UNION) && !rightChar.equalsIgnoreCase(UNION)) {\n\t\t\t\tl = inputLeft.substring(0, inputLeft.length() - 1);\n\t\t\t\tr = inputRight;\n\t\t\t} else if (!leftChar.equalsIgnoreCase(UNION) && rightChar.equalsIgnoreCase(UNION)) {\n\t\t\t\tl = inputLeft;\n\t\t\t\tr = inputRight.substring(1, inputRight.length());\n\t\t\t} else if (leftChar.equalsIgnoreCase(UNION) && rightChar.equalsIgnoreCase(UNION)) {\n\t\t\t\tl = inputLeft.substring(0, inputLeft.length() - 1);\n\t\t\t\tr = inputRight.substring(1, inputRight.length());\t\n\t\t\t} else {\n\t\t\t\tl = inputLeft;\n\t\t\t\tr = inputRight;\n\t\t\t}\t\t\t\n\t\t} else if (inputLeft.length() == 0 && inputRight.length() > 0) {\n\t\t\tl = """";\n\t\t\tunion = """";\n\t\t\tr = inputRight;\t\t\t\t\n\t\t} else if (inputLeft.length() > 0 && inputRight.length() == 0) {\n\t\t\tl = inputLeft;\n\t\t\tunion = """";\n\t\t\tr = """";\t\t\t\t\n\t\t} else if (inputLeft.length() == 0 && inputRight.length() == 0) {\n\t\t\t\tl = union = r = """";\n\t\t}\n\t\treturn (l + union + r);\n\t}\n\t\t\n}\n\n----------------------------------- SOURCE END -------------------------------------",1403192930129
error,log,,,"Problems occurred when invoking code from plug-in: ""org.eclipse.jdt.ui"".",1403192930129
error,log,,,"Error in JDT Core during reconcile",1403192930129
error,log,,,"Exception occurred during problem detection:\r\n----------------------------------- SOURCE BEGIN -------------------------------------\r\npackage com.loyauty.service.product;\r\n\r\nimport java.io.File;\r\nimport java.io.IOException;\r\nimport java.util.ArrayList;\r\nimport java.util.Date;\r\nimport java.util.Iterator;\r\nimport java.util.List;\r\n\r\nimport lombok.Getter;\r\nimport lombok.Setter;\r\n\r\nimport org.apache.log4j.Logger;\r\n\r\nimport com.loyauty.dao.core.DaoCommand;\r\nimport com.loyauty.dao.core.DaoManager;\r\nimport com.loyauty.dao.core.DaoManagerFactory;\r\nimport com.loyauty.enums.Language;\r\nimport com.loyauty.enums.PriceType;\r\nimport com.loyauty.enums.ProductStatus;\r\nimport com.loyauty.enums.Type;\r\nimport com.loyauty.exception.DaoException;\r\nimport com.loyauty.exception.ServiceException;\r\nimport com.loyauty.model.AlterProductXML;\r\nimport com.loyauty.model.AlterUserProductXML;\r\nimport com.loyauty.model.Brand;\r\nimport com.loyauty.model.Category;\r\nimport com.loyauty.model.City;\r\nimport com.loyauty.model.Image;\r\nimport com.loyauty.model.LoyaltyEnum;\r\nimport com.loyauty.model.Product;\r\nimport com.loyauty.model.Province;\r\nimport com.loyauty.model.Query;\r\nimport com.loyauty.model.ProductLink;\r\nimport com.loyauty.model.ProductModelNumber;\r\nimport com.loyauty.model.Select;\r\nimport com.loyauty.model.ShippingCity;\r\nimport com.loyauty.model.ShippingProvince;\r\nimport com.loyauty.model.ShippingTotal;\r\nimport com.loyauty.model.Specification;\r\nimport com.loyauty.model.Translation;\r\nimport com.loyauty.model.TranslationEntry;\r\nimport com.loyauty.model.User;\r\nimport com.loyauty.model.UserBrandDiscount;\r\nimport com.loyauty.model.UserCategoryDiscount;\r\nimport com.loyauty.model.UserProductPrice;\r\nimport com.loyauty.model.UserProvincePopulation;\r\nimport com.loyauty.service.ServiceImpl;\r\nimport com.loyauty.service.core.DTOFactory;\r\nimport com.loyauty.service.core.dto.AlterProductXMLDTO;\r\nimport com.loyauty.service.core.dto.AlterUserProductXMLDTO;\r\nimport com.loyauty.service.core.dto.CityDTO;\r\nimport com.loyauty.service.core.dto.CommonDTO;\r\nimport com.loyauty.service.core.dto.CommonUserDiscountDTO;\r\nimport com.loyauty.service.core.dto.ImageDTO;\r\nimport com.loyauty.service.core.dto.ProductDTO;\r\nimport com.loyauty.service.core.dto.ProvinceDTO;\r\nimport com.loyauty.service.core.dto.QueryDTO;\r\nimport com.loyauty.service.core.dto.ProductModelDTO;\r\nimport com.loyauty.service.core.dto.SearchRequestDTO;\r\nimport com.loyauty.service.core.dto.SearchRequestDTO.SearchType;\r\nimport com.loyauty.service.core.dto.ShippingCityDTO;\r\nimport com.loyauty.service.core.dto.ShippingProvinceDTO;\r\nimport com.loyauty.service.core.dto.ShippingTotalDTO;\r\nimport com.loyauty.service.core.dto.SpecificationDTO;\r\nimport com.loyauty.service.core.dto.UserDTO;\r\nimport com.loyauty.service.core.dto.UserProductDTO;\r\nimport com.loyauty.service.core.dto.UserProductPriceDTO;\r\nimport com.loyauty.service.core.dto.UserProvincePopulationDTO;\r\nimport com.loyauty.service.image.ImageService;\r\nimport com.loyauty.service.image.ImageServiceImpl;\r\nimport com.loyauty.util.CommonUtils;\r\n\r\npublic class ProductServiceImpl extends ServiceImpl implements ProductService {\r\n\t\r\n\tprivate static final Logger log = Logger.getLogger(ProductServiceImpl.class);\r\n\t\r\n\t@Setter @Getter\r\n\r\n\tprotected DaoManager daoManager;\r\n\t\r\n\tpublic ProductServiceImpl() {\r\n\t\tsetDaoManager(DaoManagerFactory.getDaoManager());\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<SpecificationDTO> getMainSpecificationByCategory(final long categoryId)\r\n\t\t\tthrows ServiceException {\r\n\t\tList<Specification> list = null;\r\n\t\ttry {\r\n\t\t\tlist = (List<Specification>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\treturn daoManager.getSpecificationDao().getMainSpecificationByCategory(categoryId);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException e) {\r\n\t\t\tthrow (new ServiceException(e));\r\n\t\t}\r\n\t\treturn DTOFactory.getSpecificationListDTO(list);\r\n\t}\r\n\t\r\n \t@Override\r\n\tpublic Long createProduct(final ProductDTO productDTO) throws ServiceException {\r\n\t\tProduct productResult = new Product();\r\n\t\t\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductResult = (Product) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t/* (non-Javadoc)\r\n\t\t\t\t * @see com.loyauty.dao.core.DaoCommand#execute(com.loyauty.dao.core.DaoManager)\r\n\t\t\t\t */\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\tthrows DaoException {\r\n\t\t\t\t\t\r\n\t\t\t\t\tProduct product = new Product();\r\n\t\t\t\t\t\r\n\t\t\t\t\t//Name\r\n\t\t\t\t\tTranslation translationName = new Translation();\r\n\t\t\t\t\tdaoManager.getTranslationDao().insertTranslation(translationName);\t\r\n\t\t\t\t\t//Eng Name\r\n\t\t\t\t\tTranslationEntry entryNameEng = new TranslationEntry(translationName.getId(), productDTO.getNameEng().getName() );\r\n\t\t\t\t\tentryNameEng.setLanguage(Language.ENGLISH);\r\n\t\t\t\t\tdaoManager.getTranslationDao().insertEntry(entryNameEng);\r\n\t\t\t\t\t//Fr Name\r\n\t\t\t\t\tTranslationEntry entryNameFr = new TranslationEntry(translationName.getId(), productDTO.getNameFr().getName());\r\n\t\t\t\t\tentryNameFr.setLanguage(Language.FRENCH);\r\n\t\t\t\t\tdaoManager.getTranslationDao().insertEntry(entryNameFr);\r\n\t\t\t\t\t\r\n\t\t\t\t\t//Description\r\n\t\t\t\t\tTranslation translationDescription = new Translation();\r\n\t\t\t\t\tdaoManager.getTranslationDao().insertTranslation(translationDescription);\r\n\t\t\t\t\t//Eng Description\r\n\t\t\t\t\tTranslationEntry entryDescriptionEng = new TranslationEntry(translationDescription.getId(), productDTO.getDescriptionEng().getName());\r\n\t\t\t\t\tentryDescriptionEng.setLanguage(Language.ENGLISH);\r\n\t\t\t\t\tdaoManager.getTranslationDao().insertEntry(entryDescriptionEng);\r\n\t\t\t\t\t//Fr Description\r\n\t\t\t\t\tTranslationEntry entryDescriptionFr = new TranslationEntry(translationDescription.getId(), productDTO.getDescriptionFr().getName());\r\n\t\t\t\t\tentryDescriptionFr.setLanguage(Language.FRENCH);\r\n\t\t\t\t\tdaoManager.getTranslationDao().insertEntry(entryDescriptionFr);\r\n\t\t\t\t\t\r\n\t\t\t\t\t//Specification\r\n\t\t\t\t\tTranslation translationSpecification = new Translation();\t\t\t\r\n\t\t\t\t\tdaoManager.getTranslationDao().insertTranslation(translationSpecification);\t\r\n\t\t\t\t\t//Eng Name\r\n\t\t\t\t\tTranslationEntry entrySpecificationEng = new TranslationEntry(translationSpecification.getId(), productDTO.getSpecificationEng().getName() );\r\n\t\t\t\t\tentrySpecificationEng.setLanguage(Language.ENGLISH);\r\n\t\t\t\t\tdaoManager.getTranslationDao().insertEntry(entrySpecificationEng);\r\n\t\t\t\t\t//Fr Name\r\n\t\t\t\t\tTranslationEntry entrySpecificationFr = new TranslationEntry(translationSpecification.getId(), productDTO.getSpecificationFr().getName());\r\n\t\t\t\t\tentrySpecificationFr.setLanguage(Language.FRENCH);\r\n\t\t\t\t\tdaoManager.getTranslationDao().insertEntry(entrySpecificationFr);\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Others\r\n\t\t\t\t\tTranslation translationOther = new Translation();\t\t\t\t\t\r\n\t\t\t\t\tdaoManager.getTranslationDao().insertTranslation(translationOther);\r\n\t\t\t\t\t// Eng Others\r\n\t\t\t\t\tTranslationEntry entryOtherEng = new TranslationEntry(translationOther.getId(), productDTO.getOtherEng().getName());\r\n\t\t\t\t\tentryOtherEng.setLanguage(Language.ENGLISH);\r\n\t\t\t\t\tdaoManager.getTranslationDao().insertEntry(entryOtherEng);\r\n\t\t\t\t\t// Fr Name\r\n\t\t\t\t\tTranslationEntry entryOtherFr = new TranslationEntry(translationOther.getId(), productDTO.getOtherFr().getName());\r\n\t\t\t\t\tentryOtherFr.setLanguage(Language.FRENCH);\r\n\t\t\t\t\tdaoManager.getTranslationDao().insertEntry(entryOtherFr);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Warranty\r\n\t\t\t\t\tTranslation translationWarranty = new Translation();\r\n\t\t\t\t\tdaoManager.getTranslationDao().insertTranslation(translationWarranty);\r\n\t\t\t\t\t// Eng Others\r\n\t\t\t\t\tTranslationEntry entryWarrantyEng = new TranslationEntry(translationWarranty.getId(), productDTO.getWarrantyEng().getName());\r\n\t\t\t\t\tentryWarrantyEng.setLanguage(Language.ENGLISH);\r\n\t\t\t\t\tdaoManager.getTranslationDao().insertEntry(entryWarrantyEng);\r\n\t\t\t\t\t// Fr Name\r\n\t\t\t\t\tTranslationEntry entryWarrantyFr = new TranslationEntry(translationWarranty.getId(), productDTO.getWarrantyFr().getName());\r\n\t\t\t\t\tentryWarrantyFr.setLanguage(Language.FRENCH);\r\n\t\t\t\t\tdaoManager.getTranslationDao().insertEntry(entryWarrantyFr);\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t//Insert Image product\r\n\t\t\t\t\tImage imageProduct = new Image();\r\n\t\t\t\t\tif(productDTO.getImage() != null) {\r\n\t\t\t\t\t\timageProduct.setName(productDTO.getImage().getName());\r\n\t\t\t\t\t\timageProduct.setRealNameImg(productDTO.getImage().getRealName());\r\n\t\t\t\t\t\timageProduct.setType(Type.PRODUCT);\r\n\t\t\t\t\t\timageProduct.setSize(productDTO.getImage().getSize());\r\n\t\t\t\t\t\timageProduct.setHeight(productDTO.getImage().getHeight());\r\n\t\t\t\t\t\timageProduct.setWidth(productDTO.getImage().getWidth());\r\n\t\t\t\t\t\timageProduct.setLarge(productDTO.getImage().isLarge());\r\n\t\t\t\t\t\timageProduct.setResolution(productDTO.getImage().getResolution());\r\n\t\t\t\t\t\timageProduct.setScore(productDTO.getImage().getScore());\r\n\t\t\t\t\t\tdaoManager.getImageDao().insertEntity(imageProduct);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t//Brand \r\n\t\t\t\t\tBrand brand = new Brand();\r\n\t\t\t\t\tbrand.setId(productDTO.getBrand().getId());\r\n\t\t\t\t\t//Category\r\n\t\t\t\t\tCategory category = new Category();\r\n\t\t\t\t\tcategory.setId(productDTO.getCategory().getId());\r\n\t\t\t\t\t\r\n\t\t\t\t\tproduct.setName(translationName);\r\n\t\t\t\t\tproduct.setDescription(translationDescription);\r\n\t\t\t\t\tproduct.setImage(imageProduct);\r\n\t\t\t\t\tproduct.setStatus(ProductStatus.AVAILABLE);\r\n\t\t\t\t\tproduct.setMsrp(productDTO.getMsrp());\r\n\t\t\t\t\tproduct.setCost(productDTO.getCost());\r\n\t\t\t\t\tproduct.setBrand(brand);\r\n\t\t\t\t\tproduct.setLoyaltySourceProductId(productDTO.getLoyaltyProductId());\r\n\t\t\t\t\tproduct.setProductHigh(productDTO.getHigh());\r\n\t\t\t\t\tproduct.setProductLong(productDTO.getLarge());\r\n\t\t\t\t\tproduct.setProductWidth(productDTO.getWidth());\r\n\t\t\t\t\tproduct.setWeight(productDTO.getWeight());\r\n\t\t\t\t\tproduct.setActualHeight(productDTO.getActualHeight());\r\n\t\t\t\t\tproduct.setActualLength(productDTO.getActualLength());\r\n\t\t\t\t\tproduct.setActualWidth(productDTO.getActualWidth());\r\n\t\t\t\t\tproduct.setActualWeight(productDTO.getActualWeight());\r\n\t\t\t\t\tproduct.setCategory(category);\r\n\t\t\t\t\tproduct.setSpecification(translationSpecification);\r\n\t\t\t\t\tproduct.setOther(translationOther);\r\n\t\t\t\t\tproduct.setNote(productDTO.getNote());\r\n\t\t\t\t\tproduct.setWereWgtDimChanged(productDTO.getWereWgtDimChanged());\r\n\t\t\t\t\tproduct.setConsideredForXML(productDTO.getConsideredForXML());\r\n\t\t\t\t\tproduct.setWarranty(translationWarranty);\r\n\t\t\t\t\tproduct.setUpc(productDTO.getUpc());\r\n\t\t\t\t\t//51 is N/A. To allow don't pick any option in edit product page in Admin\r\n\t\t\t\t\t//I do this trick\r\n\t\t\t\t\tif(productDTO.getMainFilterTypeId() != -1) {\r\n\t\t\t\t\t\tproduct.setTypeId(productDTO.getMainFilterTypeId());\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tproduct.setTypeId(new Long(51));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdaoManager.getProductDao().insertProduct(product);\r\n\t\t\t\t\t\r\n\t\t\t\t\t//Manufacture Product Id\r\n\t\t\t\t\tIterator<ProductModelDTO> stringIterator = productDTO.getManufactureProductList().iterator();\r\n\t\t\t\t\tProductModelNumber productModelNumber;\r\n\t\t\t\t\tProductModelDTO productModelDTO;\r\n\t\t\t\t\twhile(stringIterator.hasNext()) {\r\n\t\t\t\t\t\tproductModelNumber = new ProductModelNumber();\r\n\t\t\t\t\t\tproductModelDTO = (ProductModelDTO)stringIterator.next();\r\n\t\t\t\t\t\tproductModelNumber.setModelNumber(productModelDTO.getName());\r\n\t\t\t\t\t\tproductModelNumber.setQuantity(productModelDTO.getQuantity());\r\n\t\t\t\t\t\tproductModelNumber.setProductId(product.getId());\r\n\t\t\t\t\t\tproductModelNumber.setSupplier(productModelDTO.getSupplier());\r\n\t\t\t\t\t\tproductModelNumber.setPrice(productModelDTO.getPrice());\r\n\t\t\t\t\t\tproductModelNumber.setMsrp(productModelDTO.getMsrp());\r\n\t\t\t\t\t\tdaoManager.getProductDao().insertProductModelNumber(productModelNumber);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t//insert url link\r\n\t\t\t\t\tif(productDTO.getLinkList().size() > 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tProductLink productLink = new ProductLink();\r\n\t\t\t\t\t\tproductLink.setProductId(product.getId());\r\n\t\t\t\t\t\tproductLink.setLink(productDTO.getLinkList().get(0).getLink());\r\n\t\t\t\t\t\tdaoManager.getProductDao().insertProductLink(productLink);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn product;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn(productResult.getId());\r\n\t\t} catch (DaoException e) {\r\n\t\t\tthrow (new ServiceException(e));\r\n\t\t}\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic ProductDTO getProductInformation(final Long productId, final Long userId) throws ServiceException {\r\n\r\n\t\tProduct productResult = new Product();\r\n\t\t\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductResult = (Product) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\tProduct product = new Product();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setQuery(String.valueOf(productId));\r\n\t\t\t\t\tselect.setUserId(userId);\r\n\t\t\t\t\tproduct = daoManager.getProductDao().getProduct(select);\r\n\t\t\t\t\treturn product;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProductDTO(productResult));\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<UserProductDTO> getAllProdcutForProfit(final UserProductDTO userProducDTO) throws ServiceException{\r\n\r\n\t\tList <Product> productList = new ArrayList<Product>();\r\n\t\t\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List <Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t\t@Override\r\n\t\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\t\t\t//Brand\r\n\t\t\t\t\t\t\tBrand brand = null;\r\n\t\t\t\t\t\t\tif(userProducDTO.getBrandId() != null){\r\n\t\t\t\t\t\t\t\tbrand = new Brand();\r\n\t\t\t\t\t\t\t\tbrand.setId(userProducDTO.getBrandId());\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t//Category\r\n\t\t\t\t\t\t\tCategory category = null;\r\n\t\t\t\t\t\t\tif(userProducDTO.getCategoryId() != null){\r\n\t\t\t\t\t\t\t\tcategory = new Category();\r\n\t\t\t\t\t\t\t\tcategory.setId(userProducDTO.getCategoryId());\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tProduct product = new Product();\r\n\t\t\t\t\t\t\tproduct.setBrand(brand);\r\n\t\t\t\t\t\t\tproduct.setCategory(category);\t\r\n\t\t\t\t\t\t\tproduct.setUserProductStatus(userProducDTO.getUserProductStatus());\r\n\t\t\t\t\t\t\tproduct.setUserId(userProducDTO.getUserId());\r\n\t\t\t\t\t\t\tproduct.setLoyaltySourceProductId(userProducDTO.getLsProductId());\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\treturn daoManager.getProductDao().getAllProdcutForProfit(product);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\t\r\n\t\treturn(DTOFactory.getUserProductDTOList(productList));\r\n\t}\t\r\n\t\r\n\t@Override\r\n\tpublic ImageDTO addProductImage(File file, String fileName, String applicationPath, long uploaderId,\r\n\t\t\t int width, int height, int miniCoverWidth, boolean large) throws ServiceException, IOException {\r\n\t\r\n\t\tImageService ish = new ImageServiceImpl();\r\n\t\tLong tempId = new Long(0);\r\n\t\tImage image = new Image();\r\n\t\timage.setId(tempId);\r\n\t\timage.setUploaderId(uploaderId);\r\n\t\t\r\n\t\t// Validate if the name is already present in the DB\r\n\t\tString normalizedName= CommonUtils.getNormalizedProductImage(fileName);\r\n\t\t//TODO: we must create a validation in action //Validate if the image extension is JPEG or PNG\r\n\t\tint i = ish.isJPEGPNGImage(file);\r\n\t\tif (i==1) {\r\n\t\t\timage.addImageJps(file,normalizedName,fileName);\r\n\t\t}else if (i==2) {\r\n\t\t\timage.addImagePNG(file,normalizedName,fileName);\r\n\t\t}else{\r\n\t\t\tthrow new ServiceException(""Game Logo Image Format not supported "" + file.getName() );\r\n\t\t}\r\n\t\timage.setName(normalizedName);\r\n\t\timage.setRealNameImg(fileName);\r\n\t\t//Variables Initialization \r\n\t\timage.setType(Type.PRODUCT);\r\n\t\timage.setLarge(large);\r\n\t\t\r\n\t\t// Transfer the cover to the server cover/large/ directory\t\t\t\r\n\t\tif (!ish.transferProductImage(file, normalizedName, applicationPath, width, height, miniCoverWidth, large)){\r\n\t\t\tthrow new ServiceException(""Could not transfer the image"" + \r\n\t\t\t\t\t""\\nimageName:"" + file.getName() \r\n\t\t\t\t\t+ ""\\nNormalized image:"" + normalizedName);\r\n\t\t}\r\n\t\t\r\n\t\treturn DTOFactory.getImageDTO(image); \r\n\t}\t\t\r\n\t\r\n\t@Override\r\n\tpublic void updateProduct(final ProductDTO productDTO) throws ServiceException {\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t    daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\tthrows DaoException {\r\n\t\t\t\t\tProduct product = new Product();\r\n\t\t\t\t\tproduct.setUpc(productDTO.getUpc());\r\n\t\t\t\t\t//Eng Name\r\n\t\t\t\t\tdaoManager.getTranslationDao().updateEntry(new TranslationEntry(productDTO.getNameEng()));\r\n\t\t\t\t\t//Fr Name\r\n\t\t\t\t\tdaoManager.getTranslationDao().updateEntry(new TranslationEntry(productDTO.getNameFr()));\r\n\t\t\t\t\t\r\n\t\t\t\t\t//Eng Description\r\n\t\t\t\t\tdaoManager.getTranslationDao().updateEntry(new TranslationEntry(productDTO.getDescriptionEng()));\r\n\t\t\t\t\t//Fr Description\r\n\t\t\t\t\tdaoManager.getTranslationDao().updateEntry(new TranslationEntry(productDTO.getDescriptionFr()));\r\n\t\t\t\t\t\r\n\t\t\t\t\t//Eng Specification\r\n\t\t\t\t\tdaoManager.getTranslationDao().updateEntry(new TranslationEntry(productDTO.getSpecificationEng()));\r\n\t\t\t\t\t//Fr Specification\r\n\t\t\t\t\tdaoManager.getTranslationDao().updateEntry(new TranslationEntry(productDTO.getSpecificationFr()));\r\n\t\t\t\t\t\r\n\t\t\t\t\t//Eng Others\r\n\t\t\t\t\tif(productDTO.getOtherEng().getName() != null)\r\n\t\t\t\t\t\tdaoManager.getTranslationDao().updateEntry(new TranslationEntry(productDTO.getOtherEng()));\r\n\t\t\t\t\t//Fr Others\r\n\t\t\t\t\tif(productDTO.getOtherFr().getName() != null)\r\n\t\t\t\t\t\tdaoManager.getTranslationDao().updateEntry(new TranslationEntry(productDTO.getOtherFr()));\r\n\t\t\t\t\t\r\n\t\t\t\t\t//If the productDTO.getWarrantyEng is null that means that bothe warranty are null\r\n\t\t\t\t\t//So I have to insert the warranty instead of update them.\r\n\t\t\t\t\t// Warranty\r\n\t\t\t\t\tTranslation translationWarranty = new Translation();\r\n\t\t\t\t\tif(productDTO.getWarrantyEng().getId() != 0){\r\n\t\t\t\t\t\t//Eng Warranty\r\n\t\t\t\t\t\tdaoManager.getTranslationDao().updateEntry(new TranslationEntry(productDTO.getWarrantyEng()));\r\n\t\t\t\t\t\t//Fr Warranty\r\n\t\t\t\t\t\tdaoManager.getTranslationDao().updateEntry(new TranslationEntry(productDTO.getWarrantyFr()));\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\ttranslationWarranty.setId(productDTO.getWarrantyTranslationId());\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif(productDTO.getWarrantyEng() != null)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tdaoManager.getTranslationDao().insertTranslation(translationWarranty);\r\n\t\t\t\t\t\t\t// Eng Others\r\n\t\t\t\t\t\t\tTranslationEntry entryWarrantyEng = new TranslationEntry(translationWarranty.getId(), productDTO.getWarrantyEng().getName());\r\n\t\t\t\t\t\t\tentryWarrantyEng.setLanguage(Language.ENGLISH);\r\n\t\t\t\t\t\t\tdaoManager.getTranslationDao().insertEntry(entryWarrantyEng);\r\n\t\t\t\t\t\t\t// Fr Name\r\n\t\t\t\t\t\t\tTranslationEntry entryWarrantyFr = new TranslationEntry(translationWarranty.getId(), productDTO.getWarrantyFr().getName());\r\n\t\t\t\t\t\t\tentryWarrantyFr.setLanguage(Language.FRENCH);\r\n\t\t\t\t\t\t\tdaoManager.getTranslationDao().insertEntry(entryWarrantyFr);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tproduct.setWarranty(translationWarranty);\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t//Insert Image product\r\n\t\t\t\t\tImage imageProduct = new Image();\r\n\t\t\t\t\t//If the id image is null that means that the image is new.\r\n\t\t\t\t\t//So, Insert the image and update the product.\r\n\t\t\t\t\tif(productDTO.getImage() != null) {\r\n\t\t\t\t\t\tif (productDTO.getImage().getId() > 0L) {\t\t\t\t\t\t\r\n\t\t\t\t\t\t\timageProduct.setId(productDTO.getImage().getId());\r\n\t\t\t\t\t\t\timageProduct.setName(productDTO.getImage().getName());\r\n\t\t\t\t\t\t\timageProduct.setRealNameImg(productDTO.getImage().getRealName());\r\n\t\t\t\t\t\t\timageProduct.setType(Type.PRODUCT);\r\n\t\t\t\t\t\t\timageProduct.setSize(productDTO.getImage().getSize());\r\n\t\t\t\t\t\t\timageProduct.setHeight(productDTO.getImage().getHeight());\r\n\t\t\t\t\t\t\timageProduct.setWidth(productDTO.getImage().getWidth());\r\n\t\t\t\t\t\t\timageProduct.setLarge(productDTO.getImage().isLarge());\r\n\t\t\t\t\t\t\timageProduct.setResolution(productDTO.getImage().getResolution());\r\n\t\t\t\t\t\t\timageProduct.setScore(productDTO.getImage().getScore());\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t//For the image, I use the plugin and the insert or update of \r\n\t\t\t\t\t\t\t//the image is done in AjaxUploadFile So if I insert here the \r\n\t\t\t\t\t\t\t//image again, I'll get a duplicate key exception. \r\n\t\t\t\t\t\t\t//I update all the time.\r\n\t\t\t\t\t\t\t//daoManager.getImageDao().updateEntity(imageProduct);\t\t\r\n\t\t\t\t\t\t\t//I do nothing.\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t//Brand \r\n\t\t\t\t\tBrand brand = new Brand();\r\n\t\t\t\t\tbrand.setId(productDTO.getBrand().getId());\r\n\t\t\t\t\t\r\n\t\t\t\t\t//Category\r\n\t\t\t\t\tCategory category = new Category();\r\n\t\t\t\t\tcategory.setId(productDTO.getCategory().getId());\r\n\t\t\t\t\tproduct.setId(productDTO.getId());\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t if (imageProduct != null) {\r\n\t\t\t\t\t\tproduct.setImage(imageProduct);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tproduct.setMsrp(productDTO.getMsrp());\r\n\t\t\t\t\tproduct.setCost(productDTO.getCost());\r\n\t\t\t\t\tproduct.setBrand(brand);\r\n\t\t\t\t\tproduct.setLoyaltySourceProductId(productDTO.getLoyaltyProductId());\r\n\t\t\t\t\tproduct.setProductHigh(productDTO.getHigh());\r\n\t\t\t\t\tproduct.setProductLong(productDTO.getLarge());\r\n\t\t\t\t\tproduct.setProductWidth(productDTO.getWidth());\r\n\t\t\t\t\tproduct.setWeight(productDTO.getWeight());\r\n\t\t\t\t\tproduct.setActualHeight(productDTO.getActualHeight());\r\n\t\t\t\t\tproduct.setActualLength(productDTO.getActualLength());\r\n\t\t\t\t\tproduct.setActualWidth(productDTO.getActualWidth());\r\n\t\t\t\t\tproduct.setActualWeight(productDTO.getActualWeight());\r\n\t\t\t\t\tproduct.setCategory(category);\r\n\t\t\t\t\tproduct.setStatus(productDTO.getStatus());\r\n\t\t\t\t\tproduct.setNote(productDTO.getNote());\r\n\t\t\t\t\tproduct.setWereWgtDimChanged(productDTO.getWereWgtDimChanged());\r\n\t\t\t\t\tproduct.setConsideredForXML(productDTO.getConsideredForXML());\r\n\r\n\t\t\t\t\tif (productDTO.getStatus() == ProductStatus.DISCONTINUED) {\r\n\t\t\t\t\t\tproduct.setDiscontinuedStartDate(productDTO.getDiscontinuedStartDate());\r\n\t\t\t\t\t\tString productSubstitute = productDTO.getLoyaltyProductIdSub();\r\n\t\t\t\t\t\tif (productSubstitute != null) {\r\n\t\t\t\t\t\t\tif (productSubstitute.length() > 0 && !productSubstitute.matches(""^\\\\s*$"")) {\r\n\t\t\t\t\t\t\t\tproduct.setLoyaltyProductIdSub(productDTO.getLoyaltyProductIdSub());\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (productDTO.getStatus() == ProductStatus.DISABLED) {\t\t\t\t\t\t\r\n\t\t\t\t\t\tDate discontinuedStartDate = productDTO.getDiscontinuedStartDate();\r\n\t\t\t\t\t\tif (discontinuedStartDate != null) {\r\n\t\t\t\t\t\t\tproduct.setDiscontinuedStartDate(discontinuedStartDate);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tString productSubstitute = productDTO.getLoyaltyProductIdSub();\r\n\t\t\t\t\t\tif (productSubstitute != null) {\r\n\t\t\t\t\t\t\tproduct.setLoyaltyProductIdSub(productDTO.getLoyaltyProductIdSub());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//51 is N/A. To allow don't pick any option in edit product page in Admin\r\n\t\t\t\t\t//I do this trick\r\n\t\t\t\t\tif(productDTO.getMainFilterTypeId() != -1)\r\n\t\t\t\t\t\tproduct.setTypeId(productDTO.getMainFilterTypeId());\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tproduct.setTypeId(new Long(51));\r\n\t\t\t\t\t\r\n\t\t\t\t\tdaoManager.getProductDao().updateProduct(product);\r\n\t\t\t\t\t\r\n\t\t\t\t\t//Manufacture Product Id\r\n\t\t\t\t\tIterator<ProductModelDTO> stringIterator = productDTO.getManufactureProductList().iterator();\r\n\t\t\t\t\tProductModelNumber productModelNumber;\r\n\t\t\t\t\tProductModelDTO productModelDTO;\r\n\t\t\t\t\twhile(stringIterator.hasNext()) {\r\n\t\t\t\t\t\tproductModelNumber = new ProductModelNumber();\r\n\t\t\t\t\t\tproductModelDTO = (ProductModelDTO)stringIterator.next();\r\n\t\t\t\t\t\tproductModelNumber.setModelNumber(productModelDTO.getName());\r\n\t\t\t\t\t\tproductModelNumber.setQuantity(productModelDTO.getQuantity());\r\n\t\t\t\t\t\tproductModelNumber.setSupplier(productModelDTO.getSupplier());\r\n\t\t\t\t\t\tproductModelNumber.setPrice(productModelDTO.getPrice());\r\n\t\t\t\t\t\tproductModelNumber.setMsrp(productModelDTO.getMsrp());\r\n\t\t\t\t\t\tproductModelNumber.setId(productModelDTO.getId());\r\n\t\t\t\t\t\tproductModelNumber.setProductId(product.getId());\r\n\t\t\t\t\t\tif(productModelNumber.getId() != 0) {\r\n\t\t\t\t\t\t    if(!productModelDTO.getName().trim().equals(""""))\r\n\t\t\t\t\t\t    \tdaoManager.getProductDao().updateProductModelNumber(productModelNumber);\r\n\t\t\t\t\t\t    else\r\n\t\t\t\t\t\t    \tdaoManager.getProductDao().deleteProductModelNumber(productModelNumber);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t    if(!productModelDTO.getName().trim().equals("""") )\r\n\t\t\t\t\t\t\t daoManager.getProductDao().insertProductModelNumber(productModelNumber);\r\n\t\t\t\t\t\t} \r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t//link url\r\n\t\t\t\t\tif(productDTO.getLinkList() != null)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tProductLink productLink = new ProductLink();\r\n\t\t\t\t\t\tproductLink.setId(productDTO.getLinkList().get(0).getId());\r\n\t\t\t\t\t\tproductLink.setLink(productDTO.getLinkList().get(0).getLink());\r\n\t\t\t\t\t\tproductLink.setProductId(productDTO.getLinkList().get(0).getProductId());\r\n\t\t\t\t\t\tif(productLink.getId() !=0 )\r\n\t\t\t\t\t\t\tdaoManager.getProductDao().updateProductLink(productLink);\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\tdaoManager.getProductDao().insertProductLink(productLink);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn product;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException e) {\r\n\t\t\tthrow (new ServiceException(e));\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ProductDTO> getAllProdcut() throws ServiceException{\r\n\r\n\t\tList <Product> productList = new ArrayList<Product>();\r\n\t\t\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List <Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t\t@Override\r\n\t\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\t\t\treturn daoManager.getProductDao().getAllProdcut();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProductDTOList(productList));\r\n\t}\t\r\n\r\n\t@Override\r\n\tpublic void updateSellingPriceBrand(final UserProductDTO userProductDTO)\r\n\t\t\tthrows ServiceException {\r\n\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t@Override\r\n\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tUserBrandDiscount userBrandDiscount = new UserBrandDiscount();\r\n\t\t\t\t\t\tuserBrandDiscount.setBrandId(userProductDTO.getBrandId());\r\n\t\t\t\t\t\tuserBrandDiscount.setDiscount(userProductDTO.getBrandDiscount());\r\n\t\t\t\t\t\tuserBrandDiscount.setUserId(userProductDTO.getUserId());\r\n\t\t\t\t\t\t//update selling price by brand\r\n\t\t\t\t\t\tdaoManager.getProductDao().updateSellingPriceBrand(userBrandDiscount);\r\n\t\t\t\t\t\t// insert user brand discount or category\r\n\t\t\t\t\t\tUserBrandDiscount ubd = daoManager.getUserBrandDiscountDao().getUserBrandDiscount(userBrandDiscount);\r\n\t\t\t\t\t\tif( ubd == null)\r\n\t\t\t\t\t\t\tdaoManager.getUserBrandDiscountDao().insertEntity(userBrandDiscount);\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tubd.setDiscount(userBrandDiscount.getDiscount());\r\n\t\t\t\t\t\t\tdaoManager.getUserBrandDiscountDao().updateEntity(ubd);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic void updateSellingPriceCategory(final UserProductDTO userProductDTO)\r\n\t\t\tthrows ServiceException {\r\n\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t@Override\r\n\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tUserCategoryDiscount userCatDiscount = new UserCategoryDiscount();\r\n\t\t\t\t\t\tuserCatDiscount.setCategoryId(userProductDTO.getCategoryId());\r\n\t\t\t\t\t\tuserCatDiscount.setDiscount(userProductDTO.getCategoryDiscount());\r\n\t\t\t\t\t\tuserCatDiscount.setUserId(userProductDTO.getUserId());\r\n\t\t\t\t\t\t//update selling price by brand\r\n\t\t\t\t\t\tdaoManager.getProductDao().updateSellingPriceCategory(userCatDiscount);\r\n\t\t\t\t\t\t// insert user brand discount or category\r\n\t\t\t\t\t\tUserCategoryDiscount  ucd = daoManager.getUserCategoryDiscountDao().getUserCategoryDiscount(userCatDiscount);\r\n\t\t\t\t\t\tif( ucd == null)\r\n\t\t\t\t\t\t\tdaoManager.getUserCategoryDiscountDao().insertEntity(userCatDiscount);\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tucd.setDiscount(userCatDiscount.getDiscount());\r\n\t\t\t\t\t\t\tdaoManager.getUserCategoryDiscountDao().updateEntity(ucd);\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic CommonUserDiscountDTO getUserBrandDiscount(final CommonUserDiscountDTO userBrandDiscountDTO)\r\n\t\t\tthrows ServiceException {\r\n\t\tUserBrandDiscount discountResult = null;\r\n\t\ttry {\r\n\t\t\tdiscountResult = (UserBrandDiscount) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\t\r\n\t\t\t\t\tUserBrandDiscount userBrandDiscount = new UserBrandDiscount();\r\n\t\t\t\t\tuserBrandDiscount.setBrandId(userBrandDiscountDTO.getBrandId());\t\t\t\t\r\n\t\t\t\t\tuserBrandDiscount.setUserId(userBrandDiscountDTO.getUserId());\r\n\r\n\t\t\t\t\treturn daoManager.getUserBrandDiscountDao().getUserBrandDiscount(userBrandDiscount);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\t\r\n\t\tif(discountResult != null){\r\n\t\t\tCommonUserDiscountDTO udDTO = new CommonUserDiscountDTO();\r\n\t\t\tudDTO.setCategoryId(discountResult.getBrandId());\r\n\t\t\tudDTO.setUserId(discountResult.getUserId());\r\n\t\t\tudDTO.setDiscount(discountResult.getDiscount());\r\n\t\t\treturn udDTO;\t\t\t\t\t\t\t\t\t\r\n\t\t}\t\t\r\n\t\treturn null;\r\n\t}\r\n\r\n\t@Override\r\n\tpublic CommonUserDiscountDTO getUserCategoryDiscount(final CommonUserDiscountDTO userDiscountDTO) \r\n\t\t\tthrows ServiceException {\r\n\t\tUserCategoryDiscount discountResult = null;\r\n\t\ttry {\r\n\t\t\tdiscountResult = (UserCategoryDiscount) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\t\r\n\t\t\t\t\tUserCategoryDiscount userCatDiscount = new UserCategoryDiscount();\r\n\t\t\t\t\tuserCatDiscount.setCategoryId(userDiscountDTO.getCategoryId());\t\t\t\t\r\n\t\t\t\t\tuserCatDiscount.setUserId(userDiscountDTO.getUserId());\r\n\r\n\t\t\t\t\treturn daoManager.getUserCategoryDiscountDao().getUserCategoryDiscount(userCatDiscount);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\t\r\n\t\tif(discountResult != null){\r\n\t\t\tCommonUserDiscountDTO udDTO = new CommonUserDiscountDTO();\r\n\t\t\tudDTO.setCategoryId(discountResult.getCategoryId());\r\n\t\t\tudDTO.setUserId(discountResult.getUserId());\r\n\t\t\tudDTO.setDiscount(discountResult.getDiscount());\r\n\t\t\treturn udDTO;\t\t\t\t\t\t\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\treturn null;\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void updateSellingPriceProduct(final UserProductDTO producDTO)\r\n\t\t\tthrows ServiceException {\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t@Override\r\n\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tProduct product = new Product();\r\n\t\t\t\t\t\tproduct.setUserId(producDTO.getUserId());\r\n\t\t\t\t\t\tproduct.setId(producDTO.getId());\r\n\t\t\t\t\t\tproduct.setUserPrice(producDTO.getUserPrice());\r\n\t\t\t\t\t\tproduct.setPriceType(PriceType.MANUEL_PRICE_SET.getValue());\r\n\t\t\t\t\t\t//update selling price by product\r\n\t\t\t\t\t\tdaoManager.getProductDao().updateSellingPriceProduct(product);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\t\t\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic void updateUserProductStatus(final UserProductDTO producDTO)\r\n\t\t\tthrows ServiceException {\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t@Override\r\n\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tProduct product = new Product();\r\n\t\t\t\t\t\tproduct.setUserId(producDTO.getUserId());\r\n\t\t\t\t\t\tproduct.setId(producDTO.getId());\r\n\t\t\t\t\t\tproduct.setUserProductStatus(producDTO.getUserProductStatus());\r\n\t\t\t\t\t\tdaoManager.getProductDao().updateUserProductStatus(product);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\t\t\r\n\t}\r\n\t\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<CommonDTO> getAllMainSpecification(LoyaltyEnum language)\r\n\t\t\tthrows ServiceException {\r\n\t\tList<Specification> list = null;\r\n\t\ttry {\r\n\t\t\tlist = (List<Specification>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\treturn daoManager.getSpecificationDao().getAllMainSpecification();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException e) {\r\n\t\t\tthrow (new ServiceException(e));\t\t\t\r\n\t\t} \r\n\t\t\r\n\t\treturn DTOFactory.getAllCommonDTOFromSpecification(list, language);\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ProductDTO> getAllProductQuery(final QueryDTO dto)\r\n\t\t\tthrows ServiceException {\r\n\t\tList <Product> productList = new ArrayList<Product>();\r\n\t\t\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List<Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t\t@Override\r\n\t\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tQuery qry = new Query();\r\n\t\t\t\t\t\t\tBrand brand = null;\r\n\t\t\t\t\t\t\tif(dto.getBrand().getId()>0){\r\n\t\t\t\t\t\t\t\tbrand = new Brand();\r\n\t\t\t\t\t\t\t\tbrand.setId(dto.getBrand().getId());\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tCategory cat = null;\r\n\t\t\t\t\t\t\tif(dto.getCategory().getId()>0){\r\n\t\t\t\t\t\t\t\tcat = new Category();\r\n\t\t\t\t\t\t\t\tcat.setId(dto.getCategory().getId());\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tqry.setBrand(brand);\r\n\t\t\t\t\t\t\tqry.setCategory(cat);\r\n\t\t\t\t\t\t\tqry.setTypeId(null);\r\n\t\t\t\t\t\t\tqry.setDiscontinued(dto.isDiscontinued());\r\n\t\t\t\t\t\t\tqry.setDisabled(dto.isDisabled());\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\treturn daoManager.getProductDao().getAllProductQuery(qry);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getBasicProductDTOList(productList));\r\n\t}\r\n\r\n\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ProductDTO> getProductList(final SearchRequestDTO searchRequest) throws ServiceException {\r\n\t\tList <Product> productList = new ArrayList<Product>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List <Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t\t@Override\r\n\t\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\t\t\tselect.setQuery(searchRequest.getQuery());\r\n\t\t\t\t\t\t\tselect.setUserId(searchRequest.getUserId());\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif(searchRequest.getSearchType() == SearchType.NAME.getValue()){\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\treturn daoManager.getProductDao().getProductByName(select);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(searchRequest.getSearchType() == SearchType.BRAND.getValue()){\r\n\t\t\t\t\t\t\t\treturn daoManager.getProductDao().getAllProdcutByBrand(select);\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(searchRequest.getSearchType() == SearchType.CATEGORY.getValue()){\r\n\t\t\t\t\t\t\t\treturn daoManager.getProductDao().getAllProdcutByCategory(select);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(searchRequest.getSearchType() == SearchType.MAIN_SPECIFICATION.getValue()){\r\n\t\t\t\t\t\t\t\treturn daoManager.getProductDao().getAllProdcutBySpecification(select);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(searchRequest.getSearchType() == SearchType.CATEGORY_GROUP.getValue()){\r\n\t\t\t\t\t\t\t\treturn daoManager.getProductDao().getAllProdcutByCategoryGroup(select);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn daoManager.getProductDao().getAllProdcut();\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\t\t\r\n\t\treturn DTOFactory.getProductDTOList(productList);\r\n \r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<UserDTO> getAllActiveClients(final Long productId) throws ServiceException {\r\n\r\n\t\tList<User> activeClientsList = new ArrayList<User>();\r\n\t\t\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tactiveClientsList = (List<User>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\tProduct product = new Product();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setQuery(String.valueOf(productId));\r\n\t\t\t\t\tproduct = daoManager.getProductDao().getProduct(select);\r\n\t\t\t\t\treturn product.getActiveClientsList();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getActiveClients(activeClientsList));\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ProductDTO> getAllDiscontinuedProducts() throws ServiceException {\r\n\r\n\t\tList <Product> productList = new ArrayList<Product>();\r\n\t\t\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List <Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t\t@Override\r\n\t\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\t\t\treturn daoManager.getProductDao().getAllDiscontinuedProducts();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProductDTOList(productList));\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic void updateStatusToDisabled(final ProductDTO productDTO) throws ServiceException {\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t@Override\r\n\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tProduct product = new Product();\r\n\t\t\t\t\t\tproduct.setId(productDTO.getId());\r\n\t\t\t\t\t\tdaoManager.getProductDao().updateStatusToDisabled(product);\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\t\t\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic ProductDTO getProductIdFromLSProductId(final String lSProductId) throws ServiceException {\r\n\t\tProduct productResult = new Product();\r\n\t\t\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductResult = (Product) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\tProduct product = daoManager.getProductDao().getProductIdFromLSProductId(lSProductId);\r\n\t\t\t\t\treturn product;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\t\t\r\n\t\tif(productResult == null) return (null);\r\n\t\treturn (DTOFactory.getProductDTO(productResult));\t\t\t\t\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t@Override\r\n\tpublic ProductDTO getProductByLsProductId(final String lSProductId) throws ServiceException {\r\n\t\tProduct productResult = new Product();\r\n\t\t\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductResult = (Product) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\tProduct product = daoManager.getProductDao().getProductByLsProductId(lSProductId);\r\n\t\t\t\t\treturn product;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\t\t\r\n\t\tif(productResult == null) return (null);\r\n\t\treturn (DTOFactory.getProductDTO(productResult));\t\t\t\t\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t@Override \r\n\tpublic Long createUserProductPrice(final UserProductPriceDTO userProductPriceDTO) throws ServiceException {\r\n\t\tUserProductPrice userProductPriceResult = new UserProductPrice();\t\t\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tuserProductPriceResult = (UserProductPrice) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\t\t\t\t\t\r\n\t\t\t\t\tUserProductPrice userProductPrice = new UserProductPrice();\t\t\t\t\t\r\n\t\t\t\t\tuserProductPrice.setUserId(userProductPriceDTO.getUserId());\t\t\t\t\r\n\t\t\t\t\tuserProductPrice.setProductId(userProductPriceDTO.getProductId());\t\t\t\t\t\r\n\t\t\t\t\tuserProductPrice.setPrice(userProductPriceDTO.getPrice());\r\n\t\t\t\t\tuserProductPrice.setProfit(userProductPriceDTO.getProfit());\r\n\t\t\t\t\tuserProductPrice.setDiscount(userProductPriceDTO.getDiscount());\r\n\t\t\t\t\tuserProductPrice.setExcluded(userProductPriceDTO.getExcluded());\t\t\t\t\t\r\n\t\t\t\t\tuserProductPrice.setUserStatus(userProductPriceDTO.getUserStatus());\r\n\t\t\t\t\tuserProductPrice.setPriceType(userProductPriceDTO.getPriceType());\t\t\t\t\t\r\n\t\t\t\t\tdaoManager.getProductDao().insertUserProductPrice(userProductPrice);\t\t\t\t\t\r\n\t\t\t\t\treturn userProductPrice;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn userProductPriceResult.getId();\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\t\t\r\n\t}\t\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<UserProductPriceDTO> getUserProductPriceList(final Long productId) throws ServiceException {\r\n\t\tList<UserProductPrice> userProductPriceList = new ArrayList<UserProductPrice>();\t\t\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tuserProductPriceList = (List<UserProductPrice>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tList<UserProductPrice> userProductPriceListing = new ArrayList<UserProductPrice>();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setProductId(productId);\r\n\t\t\t\t\tuserProductPriceListing = daoManager.getProductDao().getUserProductPriceList(select);\t\t\t\t\t\r\n\t\t\t\t\treturn userProductPriceListing;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getUserProductPriceDTOList(userProductPriceList));\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic void updateUserProductPrice(final UserProductPriceDTO userProductPriceDTO) throws ServiceException {\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t@Override\r\n\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\t\r\n\t\t\t\t\t\tUserProductPrice userProductPrice = new UserProductPrice();\t\t\t\t\t\t\r\n\t\t\t\t\t\tuserProductPrice.setUserId(userProductPriceDTO.getUserId());\t\t\t\t\r\n\t\t\t\t\t\tuserProductPrice.setProductId(userProductPriceDTO.getProductId());\t\r\n\t\t\t\t\t\tuserProductPrice.setPrice(userProductPriceDTO.getPrice());\r\n\t\t\t\t\t\tuserProductPrice.setProfit(userProductPriceDTO.getProfit());\r\n\t\t\t\t\t\tuserProductPrice.setDiscount(userProductPriceDTO.getDiscount());\r\n\t\t\t\t\t\tuserProductPrice.setExcluded(userProductPriceDTO.getExcluded());\t\t\t\t\t\r\n\t\t\t\t\t\tuserProductPrice.setPriceType(userProductPriceDTO.getPriceType());\r\n\t\t\t\t\t\tdaoManager.getProductDao().updateUserProductPrice(userProductPrice);\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\t\t\r\n\t}\t\r\n\t\r\n\t@Override\r\n\tpublic UserProductPriceDTO getUserProductPriceInformation(final Long productId, final Long userId) throws ServiceException {\r\n\t\tUserProductPrice userProductPriceResult = new UserProductPrice();\t\t\r\n\t\ttry {\t\t\t\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tuserProductPriceResult = (UserProductPrice) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\tUserProductPrice userProductPrice = new UserProductPrice();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setProductId(productId);\r\n\t\t\t\t\tselect.setUserId(userId);\r\n\t\t\t\t\tuserProductPrice = daoManager.getProductDao().getUserProductPrice(select);\r\n\t\t\t\t\treturn userProductPrice;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn (DTOFactory.getUserProductPriceDTO(userProductPriceResult));\r\n\t}\r\n\t\r\n\t\r\n\t@Override\r\n\tpublic UserProductPriceDTO getUsrPPriceByLsproductId(final Long userId, final String lsProductId) throws ServiceException {\r\n\t\tUserProductPrice userProductPriceResult = null;\t\r\n\t\ttry {\t\t\t\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tuserProductPriceResult = (UserProductPrice) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\treturn daoManager.getProductDao().getUsrPPriceByLsproductId(userId,lsProductId);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn (DTOFactory.getUserProductPriceDTO(userProductPriceResult));\r\n\t}\r\n\r\n\t\r\n\t\r\n\t@Override\r\n\tpublic UserProductPriceDTO getUsrPPriceByProductId(final Long userId, final Long productId) throws ServiceException {\r\n\t\tUserProductPrice userProductPriceResult = null;\t\r\n\t\ttry {\t\t\t\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tuserProductPriceResult = (UserProductPrice) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\treturn daoManager.getProductDao().getUsrPPriceByProductId(userId,productId);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn (DTOFactory.getUserProductPriceDTO(userProductPriceResult));\r\n\t}\r\n\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ProvinceDTO> getAllProvinces() throws ServiceException {\r\n\t\tList<Province> provinceList = new ArrayList<Province>();\t\t\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tprovinceList = (List<Province>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\treturn daoManager.getProductDao().getAllProvinces();\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProvinceDTOList(provinceList));\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<CityDTO> getAllCities(final Long provinceId) throws ServiceException {\r\n\t\tList<City> cityList = new ArrayList<City>();\t\t\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tcityList = (List<City>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tList<City> userProductPriceListing = new ArrayList<City>();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setProvinceId(provinceId);\r\n\t\t\t\t\tuserProductPriceListing = daoManager.getProductDao().getAllCities(select);\t\t\t\r\n\t\t\t\t\treturn userProductPriceListing;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getCityDTOList(cityList));\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<CityDTO> getCities() throws ServiceException {\r\n\t\tList<City> cityList = new ArrayList<City>();\t\t\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tcityList = (List<City>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\treturn daoManager.getProductDao().getCities();\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getCityDTOList(cityList));\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic Long createShippingCity(final ShippingCityDTO shippingCityDTO) throws ServiceException {\r\n\t\tShippingCity shippingCityResult = new ShippingCity();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tshippingCityResult = (ShippingCity) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\t\t\t\t\r\n\t\t\t\t\tShippingCity shippingCity = new ShippingCity();\r\n\t\t\t\t\tshippingCity.setProductId(shippingCityDTO.getProductId());\r\n\t\t\t\t\tshippingCity.setCityId(shippingCityDTO.getCityId());\r\n\t\t\t\t\tshippingCity.setExpeditedParcelPrice(shippingCityDTO.getExpeditedParcelPrice());\r\n\t\t\t\t\tdaoManager.getProductDao().insertShippingCity(shippingCity);\r\n\t\t\t\t\treturn shippingCity;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn shippingCityResult.getId();\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic Long createShippingProvince(final ShippingProvinceDTO shippingProvinceDTO) throws ServiceException {\r\n\t\tShippingProvince shippingProvinceResult = new ShippingProvince();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tshippingProvinceResult = (ShippingProvince) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\t\t\t\t\t\r\n\t\t\t\t\tShippingProvince shippingProvince = new ShippingProvince();\r\n\t\t\t\t\tshippingProvince.setProductId(shippingProvinceDTO.getProductId());\r\n\t\t\t\t\tshippingProvince.setProvinceId(shippingProvinceDTO.getProvinceId());\r\n\t\t\t\t\tshippingProvince.setWeightedTotalProvince(shippingProvinceDTO.getWeightedTotalProvince());\r\n\t\t\t\t\tdaoManager.getProductDao().insertShippingProvince(shippingProvince);\r\n\t\t\t\t\treturn shippingProvince;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn shippingProvinceResult.getId();\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic Long createShippingTotal(final ShippingTotalDTO shippingTotalDTO) throws ServiceException {\r\n\t\tShippingTotal shippingTotalResult = new ShippingTotal();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tshippingTotalResult = (ShippingTotal) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\t\t\t\t\t\r\n\t\t\t\t\tShippingTotal shippingTotal = new ShippingTotal();\r\n\t\t\t\t\tshippingTotal.setProductId(shippingTotalDTO.getProductId());\r\n\t\t\t\t\tshippingTotal.setProvinceId(shippingTotalDTO.getProvinceId());\r\n\t\t\t\t\tshippingTotal.setUserId(shippingTotalDTO.getUserId());\r\n\t\t\t\t\tshippingTotal.setWeightedProvinceTotalWithCoverage(shippingTotalDTO.getWeightedProvinceTotalWithCoverage());\r\n\t\t\t\t\tshippingTotal.setAverageShippingTotal(shippingTotalDTO.getAverageShippingTotal());\r\n\t\t\t\t\tdaoManager.getProductDao().insertShippingTotal(shippingTotal);\r\n\t\t\t\t\treturn shippingTotal;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn shippingTotalResult.getId();\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic void updateUPPShippingCoverage(final UserProductPriceDTO userProductPriceDTO) throws ServiceException {\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t@Override\r\n\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\t\r\n\t\t\t\t\t\tUserProductPrice userProductPrice = new UserProductPrice();\r\n\t\t\t\t\t\tuserProductPrice.setUserId(userProductPriceDTO.getUserId());\t\t\t\t\r\n\t\t\t\t\t\tuserProductPrice.setProductId(userProductPriceDTO.getProductId());\r\n\t\t\t\t\t\tuserProductPrice.setShippingCoverage(userProductPriceDTO.getShippingCoverage());\r\n\t\t\t\t\t\tdaoManager.getProductDao().updateUPPShippingCoverage(userProductPrice);\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic void updateUPPShippingTotalCanada(final UserProductPriceDTO userProductPriceDTO) throws ServiceException {\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t@Override\r\n\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\t\r\n\t\t\t\t\t\tUserProductPrice userProductPrice = new UserProductPrice();\r\n\t\t\t\t\t\tuserProductPrice.setUserId(userProductPriceDTO.getUserId());\t\t\t\t\r\n\t\t\t\t\t\tuserProductPrice.setProductId(userProductPriceDTO.getProductId());\r\n\t\t\t\t\t\tuserProductPrice.setShippingTotalCanada(userProductPriceDTO.getShippingTotalCanada());\r\n\t\t\t\t\t\tdaoManager.getProductDao().updateUPPShippingTotalCanada(userProductPrice);\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ProductDTO> getProductListByCategoryGroupId(final Long categoryGroupId) throws ServiceException {\r\n\t\tList<Product> productList = new ArrayList<Product>();\t\t\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List<Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tList<Product> productListing = new ArrayList<Product>();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setCategoryGoupeId(categoryGroupId);\r\n\t\t\t\t\tproductListing = daoManager.getProductDao().getProductListByCategoryGroupId(select);\t\t\t\r\n\t\t\t\t\treturn productListing;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProductDTOList(productList));\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ProductDTO> getAllValidStatusProducts(final Long userId) throws ServiceException {\r\n\t\tList<Product> productList = new ArrayList<Product>();\t\t\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List<Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tList<Product> productListing = new ArrayList<Product>();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setUserId(userId);\r\n\t\t\t\t\tproductListing = daoManager.getProductDao().getAllValidStatusProducts(select);\t\t\t\r\n\t\t\t\t\treturn productListing;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProductDTOList(productList));\t\t\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ProductDTO> getAllValidStatusProductsForAllUsers() throws ServiceException {\r\n\t\tList<Product> productList = new ArrayList<Product>();\t\t\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List<Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\treturn daoManager.getProductDao().getAllValidStatusProductsForAllUsers();\t\t\t\r\n\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProductDTOList(productList));\t\t\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ProductDTO> getAllValidStatusProductsG(final Long userId, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Long categoryGroupId) throws ServiceException {\r\n\t\tList<Product> productList = new ArrayList<Product>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List<Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tList<Product> productListing = new ArrayList<Product>();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setUserId(userId);\r\n\t\t\t\t\tselect.setCategoryGoupeId(categoryGroupId);\r\n\t\t\t\t\tproductListing = daoManager.getProductDao().getAllValidStatusProductsG(select);\t\t\t\r\n\t\t\t\t\treturn productListing;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProductDTOList(productList));\t\t\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ProductDTO> getAllValidStatusProductsGC(final Long userId, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Long categoryGroupId, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Long categoryId) throws ServiceException {\r\n\t\tList<Product> productList = new ArrayList<Product>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List<Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tList<Product> productListing = new ArrayList<Product>();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setUserId(userId);\r\n\t\t\t\t\tselect.setCategoryGoupeId(categoryGroupId);\r\n\t\t\t\t\tselect.setCategoryId(categoryId);\r\n\t\t\t\t\tproductListing = daoManager.getProductDao().getAllValidStatusProductsGC(select);\t\t\t\r\n\t\t\t\t\treturn productListing;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProductDTOList(productList));\t\t\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ProductDTO> getAllValidStatusProductsGCT(final Long userId, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Long categoryGroupId, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Long categoryId, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Long typeId) throws ServiceException {\r\n\t\tList<Product> productList = new ArrayList<Product>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List<Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tList<Product> productListing = new ArrayList<Product>();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setUserId(userId);\r\n\t\t\t\t\tselect.setCategoryGoupeId(categoryGroupId);\r\n\t\t\t\t\tselect.setCategoryId(categoryId);\r\n\t\t\t\t\tselect.setTypeId(typeId);\r\n\t\t\t\t\tproductListing = daoManager.getProductDao().getAllValidStatusProductsGCT(select);\t\t\t\r\n\t\t\t\t\treturn productListing;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProductDTOList(productList));\t\t\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ProductDTO> getAllValidStatusProductsGCTB(final Long userId, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Long categoryGroupId, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Long categoryId, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Long typeId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Long brandId) throws ServiceException {\r\n\t\tList<Product> productList = new ArrayList<Product>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List<Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tList<Product> productListing = new ArrayList<Product>();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setUserId(userId);\r\n\t\t\t\t\tselect.setCategoryGoupeId(categoryGroupId);\r\n\t\t\t\t\tselect.setCategoryId(categoryId);\r\n\t\t\t\t\tselect.setTypeId(typeId);\r\n\t\t\t\t\tselect.setBrandId(brandId);\r\n\t\t\t\t\tproductListing = daoManager.getProductDao().getAllValidStatusProductsGCTB(select);\t\t\r\n\t\t\t\t\treturn productListing;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProductDTOList(productList));\t\t\r\n\t}\t\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ProductDTO> getAllValidStatusProductsGCB(final Long userId, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Long categoryGroupId, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Long categoryId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfinal Long brandId) throws ServiceException {\r\n\t\tList<Product> productList = new ArrayList<Product>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List<Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tList<Product> productListing = new ArrayList<Product>();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setUserId(userId);\r\n\t\t\t\t\tselect.setCategoryGoupeId(categoryGroupId);\r\n\t\t\t\t\tselect.setCategoryId(categoryId);\r\n\t\t\t\t\tselect.setBrandId(brandId);\r\n\t\t\t\t\tproductListing = daoManager.getProductDao().getAllValidStatusProductsGCB(select);\r\n\t\t\t\t\treturn productListing;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProductDTOList(productList));\t\t\r\n\t}\r\n\t/*\r\n\t@Override\r\n\tpublic ProductDTO getProductById(final Long productId) throws ServiceException {\r\n\t\tProduct productResult = new Product();\r\n\t\t\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductResult = (Product) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setProductId(productId);\r\n\t\t\t\t\tProduct product = daoManager.getProductDao().getProductById(select);\r\n\t\t\t\t\treturn product;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\t\t\r\n\t\tif(productResult == null) return (null);\r\n\t\t\treturn (DTOFactory.getProductDTO(productResult));\t\t\t\t\r\n\t}\r\n\t*/\r\n\t\r\n\t@Override\r\n\tpublic ProductDTO getProductById(final Long productId) throws ServiceException {\r\n\t\tProduct productResult = new Product();\r\n\t\t\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductResult = (Product) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setProductId(productId);\r\n\t\t\t\t\tProduct product = daoManager.getProductDao().getProductById(productId);\r\n\t\t\t\t\treturn product;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\t\t\r\n\t\tif(productResult == null) return (null);\r\n\t\t\treturn (DTOFactory.getProductDTO(productResult));\t\t\t\t\r\n\t}\r\n\t\r\n\t\r\n\t@Override\r\n\tpublic void updateShippingCityToExpeditedParcelPrice(final ShippingCityDTO shippingCityDTO) throws ServiceException {\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t@Override\r\n\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\t\r\n\t\t\t\t\t\tShippingCity shippingCity = new ShippingCity();\r\n\t\t\t\t\t\tshippingCity.setProductId(shippingCityDTO.getProductId());\r\n\t\t\t\t\t\tshippingCity.setCityId(shippingCityDTO.getCityId());\r\n\t\t\t\t\t\tshippingCity.setExpeditedParcelPrice(shippingCityDTO.getExpeditedParcelPrice());\r\n\t\t\t\t\t\tdaoManager.getProductDao().updateShippingCityToExpeditedParcelPrice(shippingCity);\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic ShippingCityDTO getShippingCity(final Long productId, final Long cityId) throws ServiceException {\r\n\t\tShippingCity shippingCityResult = new ShippingCity();\t\t\r\n\t\ttry {\t\t\t\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tshippingCityResult = (ShippingCity) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\tShippingCity shippingCity = new ShippingCity();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setProductId(productId);\r\n\t\t\t\t\tselect.setCityId(cityId);\r\n\t\t\t\t\tshippingCity = daoManager.getProductDao().getShippingCity(select);\r\n\t\t\t\t\treturn shippingCity;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getShippingCityDTO(shippingCityResult));\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic void updateShippingProvince(final ShippingProvinceDTO shippingProvinceDTO) throws ServiceException {\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t@Override\r\n\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\t\r\n\t\t\t\t\t\tShippingProvince shippingProvince = new ShippingProvince();\r\n\t\t\t\t\t\tshippingProvince.setProductId(shippingProvinceDTO.getProductId());\r\n\t\t\t\t\t\tshippingProvince.setProvinceId(shippingProvinceDTO.getProvinceId());\r\n\t\t\t\t\t\tshippingProvince.setWeightedTotalProvince(shippingProvinceDTO.getWeightedTotalProvince());\r\n\t\t\t\t\t\tdaoManager.getProductDao().updateShippingProvince(shippingProvince);\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ProductDTO> getValidProductIdByDim(final ProductDTO productDTO) throws ServiceException {\r\n\t\tList<Product> productList = new ArrayList<Product>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List<Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tProduct product = new Product();\r\n\t\t\t\t\tproduct.setId(productDTO.getId());\r\n\t\t\t\t\tproduct.setWeight(productDTO.getWeight());\r\n\t\t\t\t\tproduct.setLength(productDTO.getLarge());\r\n\t\t\t\t\tproduct.setWidth(productDTO.getWidth());\r\n\t\t\t\t\tproduct.setHeight(productDTO.getHigh());\r\n\t\t\t\t\treturn daoManager.getProductDao().getValidProductIdByDim(product);\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProductDTOList(productList));\t\t\r\n\t}\t\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ShippingCityDTO> getShippingCityListWithZeroParcelPriceByCityId(final Long cityId) throws ServiceException {\r\n\t\tList<ShippingCity> shippingCityList = new ArrayList<ShippingCity>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tshippingCityList = (List<ShippingCity>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tList<ShippingCity> shippingCityListing = new ArrayList<ShippingCity>();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setCityId(cityId);\r\n\t\t\t\t\tshippingCityListing = daoManager.getProductDao().getShippingCityListWithZeroParcelPriceByCityId(select);\r\n\t\t\t\t\treturn shippingCityListing;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getShippingCityDTOList(shippingCityList));\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic CityDTO getCity(final Long cityId) throws ServiceException {\r\n\t\tCity cityResult = new City();\t\t\r\n\t\ttry {\t\t\t\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tcityResult = (City) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\tCity city = new City();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setCityId(cityId);\r\n\t\t\t\t\tcity = daoManager.getProductDao().getCity(select);\r\n\t\t\t\t\treturn city;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getCityDTO(cityResult));\r\n\t}\r\n\t\r\n\t\r\n\t@Override\r\n\tpublic CityDTO getCityByName(final String nameCity) throws ServiceException {\t\r\n\t\tCity city=null;\r\n\t\ttry {\t\t\t\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tcity = (City) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\treturn daoManager.getProductDao().getCityByName(nameCity);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\tCityDTO cityDTO=null;\r\n\t\tif(city!=null)cityDTO=DTOFactory.getCityDTO(city);\r\n\t\treturn cityDTO;\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t@Override\r\n\tpublic ProvinceDTO getProvince(final Long provinceId) throws ServiceException {\r\n\t\tProvince provinceResult = new Province();\t\t\r\n\t\ttry {\t\t\t\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tprovinceResult = (Province) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\tProvince province = new Province();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setProvinceId(provinceId);\r\n\t\t\t\t\tprovince = daoManager.getProductDao().getProvince(select);\r\n\t\t\t\t\treturn province;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProvinceDTO(provinceResult));\r\n\t}\t\r\n\r\n\t\r\n\t\r\n\t@Override\r\n\tpublic ProvinceDTO getProvinceByCode(final String code) throws ServiceException {\r\n\t\tProvince provinceResult = new Province();\t\t\r\n\t\ttry {\t\t\t\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tprovinceResult = (Province) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\treturn daoManager.getProductDao().getProvinceByCode(code);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProvinceDTO(provinceResult));\r\n\t}\r\n\t\r\n\t\r\n\t@Override\r\n\tpublic ShippingProvinceDTO getWeightedTotalProvinceFromShippingProvince(final Long productId, final Long provinceId) throws ServiceException {\r\n\t\tShippingProvince shippingProvinceResult = new ShippingProvince();\t\t\r\n\t\ttry {\t\t\t\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tshippingProvinceResult = (ShippingProvince) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\tShippingProvince shippingProvince = new ShippingProvince();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setProductId(productId);\r\n\t\t\t\t\tselect.setProvinceId(provinceId);\r\n\t\t\t\t\tshippingProvince = daoManager.getProductDao().getWeightedTotalProvinceFromShippingProvince(select);\r\n\t\t\t\t\treturn shippingProvince;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getShippingProvinceDTO(shippingProvinceResult));\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic void updateShippingTotal(final ShippingTotalDTO shippingTotalDTO) throws ServiceException {\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t@Override\r\n\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\t\r\n\t\t\t\t\t\tShippingTotal shippingTotal = new ShippingTotal();\r\n\t\t\t\t\t\tshippingTotal.setProductId(shippingTotalDTO.getProductId());\r\n\t\t\t\t\t\tshippingTotal.setProvinceId(shippingTotalDTO.getProvinceId());\r\n\t\t\t\t\t\tshippingTotal.setUserId(shippingTotalDTO.getUserId());\r\n\t\t\t\t\t\tshippingTotal.setWeightedProvinceTotalWithCoverage(shippingTotalDTO.getWeightedProvinceTotalWithCoverage());\r\n\t\t\t\t\t\tshippingTotal.setAverageShippingTotal(shippingTotalDTO.getAverageShippingTotal());\r\n\t\t\t\t\t\tdaoManager.getProductDao().updateShippingTotal(shippingTotal);\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ShippingTotalDTO> getShippingTotalList(final Long productId, final Long userId) throws ServiceException {\r\n\t\tList<ShippingTotal> shippingTotalList = new ArrayList<ShippingTotal>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tshippingTotalList = (List<ShippingTotal>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tList<ShippingTotal> shippingTotalListing = new ArrayList<ShippingTotal>();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setProductId(productId);\r\n\t\t\t\t\tselect.setUserId(userId);\r\n\t\t\t\t\tshippingTotalListing = daoManager.getProductDao().getShippingTotalList(select);\r\n\t\t\t\t\treturn shippingTotalListing;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getShippingTotalDTOList(shippingTotalList));\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic Long createUserProvincePopulation(final UserProvincePopulationDTO userProvincePopulationDTO) throws ServiceException {\r\n\t\tUserProvincePopulation userProvincePopulationResult = new UserProvincePopulation();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tuserProvincePopulationResult = (UserProvincePopulation) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\t\t\t\t\t\r\n\t\t\t\t\tUserProvincePopulation userProvincePopulation = new UserProvincePopulation();\r\n\t\t\t\t\tuserProvincePopulation.setProvinceId(userProvincePopulationDTO.getProvinceId());\r\n\t\t\t\t\tuserProvincePopulation.setUserId(userProvincePopulationDTO.getUserId());\r\n\t\t\t\t\tuserProvincePopulation.setPopulationPercent(userProvincePopulationDTO.getPopulationPercent());\r\n\t\t\t\t\tdaoManager.getProductDao().insertUserProvincePopulation(userProvincePopulation);\r\n\t\t\t\t\treturn userProvincePopulation;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn userProvincePopulationResult.getId();\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<UserProvincePopulationDTO> getUserProvincePopulationList(final Long userId) throws ServiceException {\r\n\t\tList<UserProvincePopulation> userProvincePopulationList = new ArrayList<UserProvincePopulation>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tuserProvincePopulationList = (List<UserProvincePopulation>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tList<UserProvincePopulation> userProvincePopulationListing = new ArrayList<UserProvincePopulation>();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setUserId(userId);\r\n\t\t\t\t\tuserProvincePopulationListing = daoManager.getProductDao().getUserProvincePopulationList(select);\r\n\t\t\t\t\treturn userProvincePopulationListing;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getUserProvincePopulationDTOList(userProvincePopulationList));\t\t\r\n\t}\t\r\n\t\r\n\t@Override\r\n\tpublic void updateUserProvincePopulation(final UserProvincePopulationDTO userProvincePopulationDTO) throws ServiceException {\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t@Override\r\n\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\t\r\n\t\t\t\t\t\tUserProvincePopulation userProvincePopulation = new UserProvincePopulation();\r\n\t\t\t\t\t\tuserProvincePopulation.setUserId(userProvincePopulationDTO.getUserId());\r\n\t\t\t\t\t\tuserProvincePopulation.setProvinceId(userProvincePopulationDTO.getProvinceId());\r\n\t\t\t\t\t\tuserProvincePopulation.setPopulationPercent(userProvincePopulationDTO.getPopulationPercent());\r\n\t\t\t\t\t\tdaoManager.getProductDao().updateUserProvincePopulation(userProvincePopulation);\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ShippingCityDTO> getAllShippingCity() throws ServiceException {\r\n\t\tList<ShippingCity> shippingCityList = new ArrayList<ShippingCity>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tshippingCityList = (List<ShippingCity>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\treturn daoManager.getProductDao().getAllShippingCity();\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getShippingCityDTOList(shippingCityList));\r\n\t}\t\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ShippingProvinceDTO> getAllShippingProvince() throws ServiceException {\r\n\t\tList<ShippingProvince> shippingProvinceList = new ArrayList<ShippingProvince>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tshippingProvinceList = (List<ShippingProvince>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\treturn daoManager.getProductDao().getAllShippingProvince();\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getShippingProvinceDTOList(shippingProvinceList));\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ShippingTotalDTO> getAllShippingTotal() throws ServiceException {\r\n\t\tList<ShippingTotal> shippingTotalList = new ArrayList<ShippingTotal>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tshippingTotalList = (List<ShippingTotal>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\treturn daoManager.getProductDao().getAllShippingTotal();\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getShippingTotalDTOList(shippingTotalList));\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<UserProvincePopulationDTO> getAllUserProvincePopulation() throws ServiceException {\r\n\t\tList<UserProvincePopulation> userProvincePopulationList = new ArrayList<UserProvincePopulation>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tuserProvincePopulationList = (List<UserProvincePopulation>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\treturn daoManager.getProductDao().getAllUserProvincePopulation();\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getUserProvincePopulationDTOList(userProvincePopulationList));\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<UserProductPriceDTO> getAllUserProductPrice() throws ServiceException {\r\n\t\tList<UserProductPrice> userProductPriceList = new ArrayList<UserProductPrice>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tuserProductPriceList = (List<UserProductPrice>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\treturn daoManager.getProductDao().getAllUserProductPrice();\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getUserProductPriceDTOList(userProductPriceList));\r\n\t}\t\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ShippingTotalDTO> getShippingTotalListByUserId(final Long userId) throws ServiceException {\r\n\t\tList<ShippingTotal> shippingTotalList = new ArrayList<ShippingTotal>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tshippingTotalList = (List<ShippingTotal>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tList<ShippingTotal> shippingTotalListing = new ArrayList<ShippingTotal>();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setUserId(userId);\r\n\t\t\t\t\tshippingTotalListing = daoManager.getProductDao().getShippingTotalListByUserId(select);\r\n\t\t\t\t\treturn shippingTotalListing;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getShippingTotalDTOList(shippingTotalList));\t\r\n\t\t\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<UserProductPriceDTO> getUserProductPriceByUserId(final Long userId) throws ServiceException {\r\n\t\tList<UserProductPrice> userProductPriceList = new ArrayList<UserProductPrice>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tuserProductPriceList = (List<UserProductPrice>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tList<UserProductPrice> userProductPriceListing = new ArrayList<UserProductPrice>();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setUserId(userId);\r\n\t\t\t\t\tuserProductPriceListing = daoManager.getProductDao().getUserProductPriceByUserId(select);\r\n\t\t\t\t\treturn userProductPriceListing;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getUserProductPriceDTOList(userProductPriceList));\r\n\t}\t\r\n\t\r\n\t@Override\r\n\tpublic UserProvincePopulationDTO getUserProvincePopulation(final Long userId, final Long provinceId) throws ServiceException {\r\n\t\tUserProvincePopulation userProvincePopulationResult = new UserProvincePopulation();\r\n\t\ttry {\t\t\t\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tuserProvincePopulationResult = (UserProvincePopulation) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\tUserProvincePopulation userProvincePopulation = new UserProvincePopulation();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setUserId(userId);\r\n\t\t\t\t\tselect.setProvinceId(provinceId);\r\n\t\t\t\t\tuserProvincePopulation = daoManager.getProductDao().getUserProvincePopulation(select);\r\n\t\t\t\t\treturn userProvincePopulation;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getUserProvincePopulation(userProvincePopulationResult));\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ShippingCityDTO> getShippingCityByIDGreaterThan(final Long id) throws ServiceException {\r\n\t\tList<ShippingCity> shippingCityList = new ArrayList<ShippingCity>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tshippingCityList = (List<ShippingCity>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\treturn daoManager.getProductDao().getShippingCityByIDGreaterThan(id);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getShippingCityDTOList(shippingCityList));\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ShippingProvinceDTO> getShippingProvinceByIDGreaterThan(final Long id) throws ServiceException {\r\n\t\tList<ShippingProvince> shippingProvinceList = new ArrayList<ShippingProvince>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tshippingProvinceList = (List<ShippingProvince>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\treturn daoManager.getProductDao().getShippingProvinceByIDGreaterThan(id);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getShippingProvinceDTOList(shippingProvinceList));\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ShippingTotalDTO> getShippingTotalByIDGreaterThan(final Long id) throws ServiceException {\r\n\t\tList<ShippingTotal> shippingTotalList = new ArrayList<ShippingTotal>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tshippingTotalList = (List<ShippingTotal>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\treturn daoManager.getProductDao().getShippingTotalByIDGreaterThan(id);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getShippingTotalDTOList(shippingTotalList));\r\n\t}\t\r\n\t\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<Long> getAllValidProductIds() throws ServiceException {\r\n\t\tList<Product> productList = new ArrayList<Product>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List<Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\treturn daoManager.getProductDao().getAllValidProductIds();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProductDTOLightList(productList));\t\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ProductDTO> getValidProductsByUserIdAndExcluded(final Long userId) throws ServiceException {\r\n\t\tList<Product> productList = new ArrayList<Product>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List<Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tList<Product> productListing = new ArrayList<Product>();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setUserId(userId);\r\n\t\t\t\t\tproductListing = daoManager.getProductDao().getValidProductsByUserIdAndExcluded(select);\r\n\t\t\t\t\treturn productListing;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProductDTOList(productList));\r\n\t}\r\n\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ProductDTO> getValidProductsGreaterThanId(final Long productId) throws ServiceException {\r\n\t\tList<Product> productList = new ArrayList<Product>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List<Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tList<Product> productListing = new ArrayList<Product>();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setProductId(productId);\r\n\t\t\t\t\tproductListing = daoManager.getProductDao().getValidProductsGreaterThanId(select);\r\n\t\t\t\t\treturn productListing;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProductDTOList(productList));\r\n\t}\r\n\t\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ShippingTotalDTO> getShippingTotalListByProductId(final Long productId) throws ServiceException {\r\n\t\tList<ShippingTotal> shippingTotalList = new ArrayList<ShippingTotal>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tshippingTotalList = (List<ShippingTotal>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setProductId(productId);\r\n\t\t\t\t\treturn daoManager.getProductDao().getShippingTotalListByProductId(select);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getShippingTotalDTOList(shippingTotalList));\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<UserProductPriceDTO> getNullsShippingTotalCanadaOnUserProductPrice(final Long productId) throws ServiceException {\r\n\t\tList<UserProductPrice> userProductPriceList = new ArrayList<UserProductPrice>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tuserProductPriceList = (List<UserProductPrice>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tList<UserProductPrice> userProductPriceListing = new ArrayList<UserProductPrice>();\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setProductId(productId);\r\n\t\t\t\t\tuserProductPriceListing = daoManager.getProductDao().getNullsShippingTotalCanadaOnUserProductPrice(select);\r\n\t\t\t\t\treturn userProductPriceListing;\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getUserProductPriceDTOList(userProductPriceList));\t\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic void updateAmendingProduct(final ProductDTO productDTO) throws ServiceException {\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t    daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\tthrows DaoException {\r\n\t\t\t\t\tProduct product = new Product();\r\n\t\t\t\t\tproduct.setId(productDTO.getId());\r\n\t\t\t\t\tdaoManager.getTranslationDao().updateEntry(new TranslationEntry(productDTO.getNameEng()));\r\n\t\t\t\t\tdaoManager.getTranslationDao().updateEntry(new TranslationEntry(productDTO.getNameFr()));\r\n\t\t\t\t\tdaoManager.getTranslationDao().updateEntry(new TranslationEntry(productDTO.getDescriptionEng()));\r\n\t\t\t\t\tdaoManager.getTranslationDao().updateEntry(new TranslationEntry(productDTO.getDescriptionFr()));\r\n\t\t\t\t\tdaoManager.getTranslationDao().updateEntry(new TranslationEntry(productDTO.getSpecificationEng()));\r\n\t\t\t\t\tdaoManager.getTranslationDao().updateEntry(new TranslationEntry(productDTO.getSpecificationFr()));\r\n\t\t\t\t\tif(productDTO.getOtherEng().getName() != null) {\r\n\t\t\t\t\t\tdaoManager.getTranslationDao().updateEntry(new TranslationEntry(productDTO.getOtherEng()));\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(productDTO.getOtherFr().getName() != null) {\r\n\t\t\t\t\t\tdaoManager.getTranslationDao().updateEntry(new TranslationEntry(productDTO.getOtherFr()));\r\n\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t\tproduct.setNote(productDTO.getNote());\r\n\t\t\t\t\tdaoManager.getProductDao().updateAmendingProduct(product);\r\n\t\t\t\t\treturn product;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException e) {\r\n\t\t\tthrow (new ServiceException(e));\r\n\t\t}\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic Boolean existsOnAlterProductXML(final Long productId) throws ServiceException {\r\n\t\tBoolean outcome = false;\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\toutcome = (Boolean) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setProductId(productId);\r\n\t\t\t\t\treturn (daoManager.getProductDao().getAlterProductXMLByProductId(select) != null);\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn outcome;\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic Boolean existsOnAlterUserProductXML(final Long productId, final Long userId) throws ServiceException {\r\n\t\tBoolean outcome = false;\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\toutcome = (Boolean) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setUserId(userId);\r\n\t\t\t\t\tselect.setProductId(productId);\r\n\t\t\t\t\treturn (daoManager.getProductDao().getAlterUserProductXMLByProductIdAndUserId(select) != null);\r\n\t\t\t\t}\r\n\t\t\t});\t\t\t\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn outcome;\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic void updateAlterUserProductXML(final AlterUserProductXMLDTO alterUserProductXMLDTO) throws ServiceException {\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t@Override\r\n\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\t\r\n\t\t\t\t\t\tAlterUserProductXML alterUserProductXML = new AlterUserProductXML();\r\n\t\t\t\t\t\talterUserProductXML.setUserId(alterUserProductXMLDTO.getUserId());\r\n\t\t\t\t\t\talterUserProductXML.setProductId(alterUserProductXMLDTO.getProductId());\r\n\t\t\t\t\t\talterUserProductXML.setPriceDiscount(alterUserProductXMLDTO.getPriceDiscount());\r\n\t\t\t\t\t\talterUserProductXML.setExcluded(alterUserProductXMLDTO.getExcluded());\r\n\t\t\t\t\t\talterUserProductXML.setShipping(alterUserProductXMLDTO.getShipping());\r\n\t\t\t\t\t\talterUserProductXML.setUserProductToBeExecuted(alterUserProductXMLDTO.getUserProductToBeExecuted());\r\n\t\t\t\t\t\talterUserProductXML.setExcludedMeaning(alterUserProductXMLDTO.getExcludedMeaning());\r\n\t\t\t\t\t\tdaoManager.getProductDao().updateAlterUserProductXML(alterUserProductXML);\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic void updateAlterProductXML(final AlterProductXMLDTO alterProductXMLDTO) throws ServiceException {\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t@Override\r\n\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\t\r\n\t\t\t\t\t\tAlterProductXML alterProductXML = new AlterProductXML();\r\n\t\t\t\t\t\talterProductXML.setProductId(alterProductXMLDTO.getProductId());\r\n\t\t\t\t\t\talterProductXML.setBrandId(alterProductXMLDTO.getBrandId());\r\n\t\t\t\t\t\talterProductXML.setCategoryId(alterProductXMLDTO.getCategoryId());\r\n\t\t\t\t\t\talterProductXML.setTypeId(alterProductXMLDTO.getTypeId());\r\n\t\t\t\t\t\talterProductXML.setImageId(alterProductXMLDTO.getImageId());\r\n\t\t\t\t\t\talterProductXML.setStatusId(alterProductXMLDTO.getStatusId());\r\n\t\t\t\t\t\talterProductXML.setNameEn(alterProductXMLDTO.getNameEn());\r\n\t\t\t\t\t\talterProductXML.setNameFr(alterProductXMLDTO.getNameFr());\r\n\t\t\t\t\t\talterProductXML.setDescriptionEn(alterProductXMLDTO.getDescriptionEn());\r\n\t\t\t\t\t\talterProductXML.setDescriptionFr(alterProductXMLDTO.getDescriptionFr());\r\n\t\t\t\t\t\talterProductXML.setSpecificationEn(alterProductXMLDTO.getSpecificationEn());\r\n\t\t\t\t\t\talterProductXML.setSpecificationFr(alterProductXMLDTO.getSpecificationFr());\r\n\t\t\t\t\t\talterProductXML.setOtherEn(alterProductXMLDTO.getOtherEn());\r\n\t\t\t\t\t\talterProductXML.setOtherFr(alterProductXMLDTO.getOtherFr());\r\n\t\t\t\t\t\talterProductXML.setWarrantyEn(alterProductXMLDTO.getWarrantyEn());\r\n\t\t\t\t\t\talterProductXML.setWarrantyFr(alterProductXMLDTO.getWarrantyFr());\r\n\t\t\t\t\t\talterProductXML.setDimensions(alterProductXMLDTO.getDimensions());\r\n\t\t\t\t\t\talterProductXML.setWeight(alterProductXMLDTO.getWeight());\r\n\t\t\t\t\t\talterProductXML.setModelNumber(alterProductXMLDTO.getModelNumber());\r\n\t\t\t\t\t\talterProductXML.setMsrp(alterProductXMLDTO.getMsrp());\r\n\t\t\t\t\t\talterProductXML.setShipping(alterProductXMLDTO.getShipping());\r\n\t\t\t\t\t\talterProductXML.setProductToBeExecuted(alterProductXMLDTO.getProductToBeExecuted());\r\n\t\t\t\t\t\tdaoManager.getProductDao().updateAlterProductXML(alterProductXML);\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\t\t\r\n\t}\t\r\n\t\r\n\t@Override\r\n\tpublic Long createAlterUserProductXML(final AlterUserProductXMLDTO alterUserProductXMLDTO) throws ServiceException {\r\n\t\tAlterUserProductXML alterUserProductXMLResult = new AlterUserProductXML();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\talterUserProductXMLResult = (AlterUserProductXML) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\t\t\t\t\t\r\n\t\t\t\t\tAlterUserProductXML alterUserProductXML = new AlterUserProductXML();\r\n\t\t\t\t\talterUserProductXML.setUserId(alterUserProductXMLDTO.getUserId());\r\n\t\t\t\t\talterUserProductXML.setProductId(alterUserProductXMLDTO.getProductId());\r\n\t\t\t\t\talterUserProductXML.setPriceDiscount(alterUserProductXMLDTO.getPriceDiscount());\r\n\t\t\t\t\talterUserProductXML.setExcluded(alterUserProductXMLDTO.getExcluded());\r\n\t\t\t\t\talterUserProductXML.setShipping(alterUserProductXMLDTO.getShipping());\r\n\t\t\t\t\talterUserProductXML.setUserProductToBeExecuted(alterUserProductXMLDTO.getUserProductToBeExecuted());\r\n\t\t\t\t\talterUserProductXML.setExcludedMeaning(alterUserProductXMLDTO.getExcludedMeaning());\r\n\t\t\t\t\tdaoManager.getProductDao().insertAlterUserProductXML(alterUserProductXML);\r\n\t\t\t\t\treturn alterUserProductXML;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn alterUserProductXMLResult.getId();\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\r\n\t@Override\r\n\tpublic Long createAlterProductXML(final AlterProductXMLDTO alterProductXMLDTO) throws ServiceException {\r\n\t\tAlterProductXML alterProductXMLResult = new AlterProductXML();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\talterProductXMLResult = (AlterProductXML) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\t\t\t\t\t\r\n\t\t\t\t\tAlterProductXML alterProductXML = new AlterProductXML();\r\n\t\t\t\t\talterProductXML.setProductId(alterProductXMLDTO.getProductId());\r\n\t\t\t\t\talterProductXML.setBrandId(alterProductXMLDTO.getBrandId());\r\n\t\t\t\t\talterProductXML.setCategoryId(alterProductXMLDTO.getCategoryId());\r\n\t\t\t\t\talterProductXML.setTypeId(alterProductXMLDTO.getTypeId());\r\n\t\t\t\t\talterProductXML.setImageId(alterProductXMLDTO.getImageId());\r\n\t\t\t\t\talterProductXML.setStatusId(alterProductXMLDTO.getStatusId());\r\n\t\t\t\t\talterProductXML.setNameEn(alterProductXMLDTO.getNameEn());\r\n\t\t\t\t\talterProductXML.setNameFr(alterProductXMLDTO.getNameFr());\r\n\t\t\t\t\talterProductXML.setDescriptionEn(alterProductXMLDTO.getDescriptionEn());\r\n\t\t\t\t\talterProductXML.setDescriptionFr(alterProductXMLDTO.getDescriptionFr());\r\n\t\t\t\t\talterProductXML.setSpecificationEn(alterProductXMLDTO.getSpecificationEn());\r\n\t\t\t\t\talterProductXML.setSpecificationFr(alterProductXMLDTO.getSpecificationFr());\r\n\t\t\t\t\talterProductXML.setOtherEn(alterProductXMLDTO.getOtherEn());\r\n\t\t\t\t\talterProductXML.setOtherFr(alterProductXMLDTO.getOtherFr());\r\n\t\t\t\t\talterProductXML.setWarrantyEn(alterProductXMLDTO.getWarrantyEn());\r\n\t\t\t\t\talterProductXML.setWarrantyFr(alterProductXMLDTO.getWarrantyFr());\r\n\t\t\t\t\talterProductXML.setDimensions(alterProductXMLDTO.getDimensions());\r\n\t\t\t\t\talterProductXML.setWeight(alterProductXMLDTO.getWeight());\r\n\t\t\t\t\talterProductXML.setModelNumber(alterProductXMLDTO.getModelNumber());\r\n\t\t\t\t\talterProductXML.setMsrp(alterProductXMLDTO.getMsrp());\r\n\t\t\t\t\talterProductXML.setShipping(alterProductXMLDTO.getShipping());\r\n\t\t\t\t\talterProductXML.setProductToBeExecuted(alterProductXMLDTO.getProductToBeExecuted());\r\n\t\t\t\t\tdaoManager.getProductDao().insertAlterProductXML(alterProductXML);\r\n\t\t\t\t\treturn alterProductXML;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn alterProductXMLResult.getId();\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ProductDTO> getProductsAsOfConsideredForXML() throws ServiceException {\r\n\t\tList<Product> productList = new ArrayList<Product>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List<Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\treturn daoManager.getProductDao().getProductsAsOfConsideredForXML();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProductDTOList(productList));\r\n\t}\r\n\t\t\r\n\t@Override\r\n\tpublic AlterUserProductXMLDTO getAlterUserProductXML(final Long userId, final Long productId) throws ServiceException {\r\n\t\tAlterUserProductXML alterUserProductXMLResult = new AlterUserProductXML();\r\n\t\ttry {\t\t\t\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\talterUserProductXMLResult = (AlterUserProductXML) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setUserId(userId);\r\n\t\t\t\t\tselect.setProductId(productId);\r\n\t\t\t\t\treturn daoManager.getProductDao().getAlterUserProductXMLByProductIdAndUserId(select);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getAlterUserProductXML(alterUserProductXMLResult));\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic AlterProductXMLDTO getAlterProductXML(final Long productId) throws ServiceException {\r\n\t\tAlterProductXML alterProductXMLResult = new AlterProductXML();\r\n\t\ttry {\t\t\t\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\talterProductXMLResult = (AlterProductXML) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setProductId(productId);\r\n\t\t\t\t\treturn daoManager.getProductDao().getAlterProductXMLByProductId(select);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getAlterProductXML(alterProductXMLResult));\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic void closeProductConsideredForXML(final Long productId) throws ServiceException {\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t@Override\r\n\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) \r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\t\tselect.setProductId(productId);\r\n\t\t\t\t\t\tdaoManager.getProductDao().closeProductConsideredForXML(select);\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void closeAlterProductXML(final Long productId) throws ServiceException {\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t@Override\r\n\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) \r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\t\tselect.setProductId(productId);\r\n\t\t\t\t\t\tdaoManager.getProductDao().closeAlterProductXML(select);\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void closeAlterUserProductXML(final Long userId, final Long productId) throws ServiceException {\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t@Override\r\n\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) \r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\t\tselect.setUserId(userId);\r\n\t\t\t\t\t\tselect.setProductId(productId);\r\n\t\t\t\t\t\tdaoManager.getProductDao().closeAlterUserProductXML(select);\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ProductDTO> getWereWgtDimChangedFromProduct() throws ServiceException {\r\n\t\tList<Product> productList = new ArrayList<Product>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List<Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\treturn daoManager.getProductDao().getWereWgtDimChangedFromProduct();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProductDTOList(productList));\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic void closeProductWereWgtDimChanged(final Long productId) throws ServiceException {\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) \r\n\t\t\t\tthrows DaoException {\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setProductId(productId);\r\n\t\t\t\t\tdaoManager.getProductDao().closeProductWereWgtDimChanged(select);\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic Boolean existsShippingCity(final Long productId, final Long cityId) throws ServiceException {\r\n\t\treturn (getShippingCity(productId, cityId) != null);\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic ShippingProvinceDTO getShippingProvince(final Long productId, final Long provinceId) throws ServiceException {\r\n\t\tShippingProvince shippingProvinceResult = new ShippingProvince();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tshippingProvinceResult = (ShippingProvince) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setProductId(productId);\r\n\t\t\t\t\tselect.setProvinceId(provinceId);\r\n\t\t\t\t\treturn daoManager.getProductDao().getShippingProvince(select);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getShippingProvinceDTO(shippingProvinceResult));\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic Boolean existsShippingProvince(final Long productId, final Long provinceId) throws ServiceException {\r\n\t\tShippingProvinceDTO shippingProvinceDTO = getShippingProvince(productId, provinceId);\r\n\t\treturn (shippingProvinceDTO != null);\r\n\t}\r\n\r\n\t@Override\r\n\tpublic ShippingTotalDTO getShippingTotal(final Long productId, final Long provinceId, final Long userId) throws ServiceException {\r\n\t\tShippingTotal shippingTotalResult = new ShippingTotal();\r\n\t\ttry {\t\t\t\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tshippingTotalResult = (ShippingTotal) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setProductId(productId);\r\n\t\t\t\t\tselect.setProvinceId(provinceId);\r\n\t\t\t\t\tselect.setUserId(userId);\r\n\t\t\t\t\treturn daoManager.getProductDao().getShippingTotal(select);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getShippingTotalDTO(shippingTotalResult));\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic Boolean existsShippingTotal(final Long productId, final Long provinceId, final Long userId) throws ServiceException {\r\n\t\tShippingTotalDTO shippingTotalDTO = getShippingTotal(productId, provinceId, userId);\r\n\t\treturn (shippingTotalDTO != null);\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic void saveOldImageIdBeforeUpdate(final Long productId) throws ServiceException {\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) \r\n\t\t\t\tthrows DaoException {\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setProductId(productId);\r\n\t\t\t\t\tdaoManager.getProductDao().saveOldImageIdBeforeUpdate(select);\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ProductDTO> getProductBetween(final Long lower, final Long upper) throws ServiceException {\r\n\t\tList<Product> productList = new ArrayList<Product>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List<Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\tList<Product> productListing = new ArrayList<Product>();\t\t\t\t\t\r\n\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\tselect.setLower(lower);\r\n\t\t\t\t\tselect.setUpper(upper);\t\t\t\t\r\n\t\t\t\t\tproductListing = daoManager.getProductDao().getProductBetween(select);\r\n\t\t\t\t\treturn productListing;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProductDTOList(productList));\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\t\r\n\t@Override\t\r\n\tpublic List<Long> getShippingRepeats(final ProductDTO productDTO) throws ServiceException {\r\n\t\tList<Product> productList = new ArrayList<Product>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List<Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) \r\n\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\t\tProduct product = new Product();\r\n\t\t\t\t\t\tproduct.setId(productDTO.getId());\r\n\t\t\t\t\t\tproduct.setWeight(productDTO.getWeight());\r\n\t\t\t\t\t\tproduct.setLength(productDTO.getLarge());\r\n\t\t\t\t\t\tproduct.setWidth(productDTO.getWidth());\r\n\t\t\t\t\t\tproduct.setHeight(productDTO.getHigh());\r\n\t\t\t\t\t\treturn daoManager.getProductDao().getShippingRepeats(product);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn (DTOFactory.getProductDTOLightList(productList));\t\t\t\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<Long> getWereWgtDimChanged() throws ServiceException {\r\n\t\tList<Product> productList = new ArrayList<Product>();\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List<Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager) throws DaoException {\r\n\t\t\t\t\treturn daoManager.getProductDao().getWereWgtDimChanged();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProductDTOLightList(productList));\t\r\n\t}\r\n\r\n\t@Override\r\n\tpublic boolean excludeProductsByBrandAndUser(final Long brandId, final Long userId,final Boolean exclude)\r\n\t\t\t\t   throws ServiceException {\r\n\t\tboolean result=false;\t\t\r\n\t\ttry{\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tresult = (Boolean) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(DaoManager daoManager) throws DaoException {\t\t\t\r\n\t\t\t\t\treturn daoManager.getProductDao().excludeProductsByBrandAndUser(brandId, userId,exclude);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}catch (DaoException de) {\r\n\t\t\ttry {\r\n\t\t\t\tthrow new ServiceException(de);\r\n\t\t\t} catch (ServiceException e) {\r\n\t\t\t\te.printStackTrace();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\t@Override\r\n\tpublic boolean isUserBrandExcluded(final Long brandId, final Long userId)throws ServiceException {\r\n\t\t\r\n\t\tBoolean result=false;\t\t\r\n\t\ttry{\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tresult = (Boolean) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(DaoManager daoManager) throws DaoException {\t\t\t\r\n\t\t\t\t\treturn daoManager.getProductDao().isUserBrandExcluded(brandId, userId);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}catch (DaoException de) {\r\n\t\t\ttry {\r\n\t\t\t\tthrow new ServiceException(de);\r\n\t\t\t} catch (ServiceException e) {\r\n\t\t\t\t// TODO Auto-generated catch block\r\n\t\t\t\te.printStackTrace();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic boolean generatProfitByBrand(final Long brandId, final Long userId, final String percentProfit)\r\n\t\t\tthrows ServiceException {\r\n\t\tboolean result=false;\t\t\r\n\t\ttry{\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tresult = (Boolean) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(DaoManager daoManager) throws DaoException {\t\t\t\r\n\t\t\t\t\treturn daoManager.getProductDao().generatProfitByBrand(brandId, userId, percentProfit);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}catch (DaoException de) {\r\n\t\t\ttry {\r\n\t\t\t\tthrow new ServiceException(de);\r\n\t\t\t} catch (ServiceException e) {\r\n\t\t\t\te.printStackTrace();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic boolean generatProfitByCategory(final Long categoryId, final Long userId, final String percentProfit)\r\n\t\t\tthrows ServiceException {\r\n\t\tboolean result=false;\t\t\r\n\t\ttry{\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tresult = (Boolean) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(DaoManager daoManager) throws DaoException {\t\t\t\r\n\t\t\t\t\treturn daoManager.getProductDao().generatProfitByCategory(categoryId, userId,percentProfit);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}catch (DaoException de) {\r\n\t\t\ttry {\r\n\t\t\t\tthrow new ServiceException(de);\r\n\t\t\t} catch (ServiceException e) {\r\n\t\t\t\te.printStackTrace();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic Long nbProductActiveByBrand(final Long brandId, final Long userId)\r\n\t\t\tthrows ServiceException {\r\n\t\tLong result=1L;\t\t\r\n\t\ttry{\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tresult = (Long) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(DaoManager daoManager) throws DaoException {\t\t\t\r\n\t\t\t\t\treturn daoManager.getProductDao().nbProductActiveByBrand(brandId, userId);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}catch (DaoException de) {\r\n\t\t\ttry {\r\n\t\t\t\tthrow new ServiceException(de);\r\n\t\t\t} catch (ServiceException e) {\r\n\t\t\t\t// TODO Auto-generated catch block\r\n\t\t\t\te.printStackTrace();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\t\r\n\t@SuppressWarnings(""unchecked"")\r\n\t@Override\r\n\tpublic List<ProductDTO> getAllProdcutAnyStatus() throws ServiceException{\r\n\t\t\r\n\t\tList <Product> productList = new ArrayList<Product>();\r\n\t\t\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tproductList = (List <Product>) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t\t@Override\r\n\t\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\t\t\treturn daoManager.getProductDao().getAllProdcutAnyStatus();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t\treturn(DTOFactory.getProductDTOList(productList));\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic void transferToUser(final Long from, final Long to) throws ServiceException {\t\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t@Override\r\n\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tSelect selectFrom = new Select();\r\n\t\t\t\t\t\tselectFrom.setFrom(from);\r\n\t\t\t\t\t\tselectFrom.setTo(to);\r\n\t\t\t\t\t\tselectFrom.setUserId(from);\t\t\t\t\t\r\n\t\t\t\t\t\tSelect selectToUserProvincePopulation = new Select();\r\n\t\t\t\t\t\tselectToUserProvincePopulation.setFrom(from);\r\n\t\t\t\t\t\tselectToUserProvincePopulation.setTo(to);\r\n\t\t\t\t\t\tselectToUserProvincePopulation.setUserId(to);\t\t\t\t\r\n\t\t\t\t\t\tList<UserProvincePopulation> userProvincePopulationListFrom = daoManager.getProductDao().getUserProvincePopulationByUserId(selectFrom);\r\n\t\t\t\t\t\tUserProvincePopulation userProvincePopulationTo = null;\r\n\t\t\t\t\t\tif (userProvincePopulationListFrom != null && userProvincePopulationListFrom.size() > 0) {\r\n\t\t\t\t\t\t\tfor (UserProvincePopulation userProvincePopulationFrom : userProvincePopulationListFrom) { \r\n\t\t\t\t\t\t\t\tif (userProvincePopulationFrom != null) {\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tselectToUserProvincePopulation.setProvinceId(userProvincePopulationFrom.getProvinceId());\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tuserProvincePopulationTo = daoManager.getProductDao().getUserProvincePopulation(selectToUserProvincePopulation);\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tuserProvincePopulationFrom.setUserId(to);\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tif (userProvincePopulationTo != null) {\r\n\t\t\t\t\t\t\t\t\t\tuserProvincePopulationFrom.setId(userProvincePopulationTo.getId());\r\n\t\t\t\t\t\t\t\t\t\tdaoManager.getProductDao().updateUserProvincePopulation(userProvincePopulationFrom);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tdaoManager.getProductDao().insertUserProvincePopulation(userProvincePopulationFrom);\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tuserProvincePopulationListFrom = null;\r\n\t\t\t\t\t\tuserProvincePopulationTo = null;\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tSelect selectToShippingTotal = new Select();\r\n\t\t\t\t\t\tselectToShippingTotal.setFrom(from);\r\n\t\t\t\t\t\tselectToShippingTotal.setTo(to);\r\n\t\t\t\t\t\tselectToShippingTotal.setUserId(to);\t\t\t\t\t\t\r\n\t\t\t\t\t\tList<ShippingTotal> shippingTotalListFrom = daoManager.getProductDao().getShippingTotalListByUserId(selectFrom);\t\t\t\t\t\t\r\n\t\t\t\t\t\tShippingTotal shippingTotalTo = null;\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (shippingTotalListFrom != null && shippingTotalListFrom.size() > 0) {\r\n\t\t\t\t\t\t\tfor (ShippingTotal shippingTotalFrom : shippingTotalListFrom) {\r\n\t\t\t\t\t\t\t\tif (shippingTotalFrom != null) {\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tselectToShippingTotal.setProductId(shippingTotalFrom.getProductId());\r\n\t\t\t\t\t\t\t\t\tselectToShippingTotal.setProvinceId(shippingTotalFrom.getProvinceId());\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tshippingTotalTo = daoManager.getProductDao().getShippingTotal(selectToShippingTotal);\r\n\t\t\t\t\t\t\t\t\tshippingTotalFrom.setUserId(to);\r\n\t\t\t\t\t\t\t\t\tif (shippingTotalTo != null) {\r\n\t\t\t\t\t\t\t\t\t\tshippingTotalFrom.setId(shippingTotalTo.getId());\r\n\t\t\t\t\t\t\t\t\t\tdaoManager.getProductDao().updateShippingTotal(shippingTotalFrom);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tdaoManager.getProductDao().insertShippingTotal(shippingTotalFrom);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tshippingTotalListFrom = null;\r\n\t\t\t\t\t\tshippingTotalTo = null;\r\n\t\t\t\t\t\tSelect selectToUserProductPrice = new Select();\r\n\t\t\t\t\t\tselectToUserProductPrice.setFrom(from);\r\n\t\t\t\t\t\tselectToUserProductPrice.setTo(to);\r\n\t\t\t\t\t\tselectToUserProductPrice.setUserId(to);\t\t\t\r\n\t\t\t\t\t\tList<UserProductPrice> userProductPriceListFrom = daoManager.getProductDao().getUserProductPriceByUserId(selectFrom);\r\n\t\t\t\t\t\tUserProductPrice userProductPriceTo = null;\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (userProductPriceListFrom != null && userProductPriceListFrom.size() > 0) {\r\n\t\t\t\t\t\t\tfor (UserProductPrice userProductPriceFrom : userProductPriceListFrom) { \r\n\t\t\t\t\t\t\t\tif (userProductPriceFrom != null) {\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tselectToUserProductPrice.setProductId(userProductPriceFrom.getProductId());\r\n\t\t\t\t\t\t\t\t\tuserProductPriceTo = daoManager.getProductDao().getUserProductPrice(selectToUserProductPrice);\r\n\t\t\t\t\t\t\t\t\tuserProductPriceFrom.setUserId(to);\r\n\t\t\t\t\t\t\t\t\tif (userProductPriceTo != null) {\r\n\t\t\t\t\t\t\t\t\t\tuserProductPriceFrom.setId(userProductPriceTo.getId());\r\n\t\t\t\t\t\t\t\t\t\tdaoManager.getProductDao().updateUserProductPrice(userProductPriceFrom);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tdaoManager.getProductDao().insertUserProductPriceShipping(userProductPriceFrom);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tuserProductPriceListFrom = null;\r\n\t\t\t\t\t\tuserProductPriceTo = null;\r\n\t\t\t\t\t\tselectFrom = null;\r\n\t\t\t\t\t\tselectToUserProvincePopulation = null;\r\n\t\t\t\t\t\tselectToShippingTotal = null;\r\n\t\t\t\t\t\tselectToUserProductPrice = null;\t\t\t\t\t\t\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\t\t\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic void transferToUserByCreationDate(final Long from, final Long to, final Date updateDate) throws ServiceException {\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t@Override\r\n\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tSelect selectFrom = new Select();\r\n\t\t\t\t\t\tselectFrom.setFrom(from);\r\n\t\t\t\t\t\tselectFrom.setTo(to);\r\n\t\t\t\t\t\tselectFrom.setUserId(from);\r\n\t\t\t\t\t\tselectFrom.setUpdateDate(updateDate);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tSelect selectToShippingTotal = new Select();\r\n\t\t\t\t\t\tselectToShippingTotal.setFrom(from);\r\n\t\t\t\t\t\tselectToShippingTotal.setTo(to);\r\n\t\t\t\t\t\tselectToShippingTotal.setUserId(to);\r\n\t\t\t\t\t\tList<ShippingTotal> shippingTotalListFrom = daoManager.getProductDao().getShippingTotalListByUserId(selectFrom);\t\t\t\t\t\r\n\t\t\t\t\t\tShippingTotal shippingTotalTo = null;\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (shippingTotalListFrom != null && shippingTotalListFrom.size() > 0) {\r\n\t\t\t\t\t\t\tfor (ShippingTotal shippingTotalFrom : shippingTotalListFrom) {\r\n\t\t\t\t\t\t\t\tif (shippingTotalFrom != null) {\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tselectToShippingTotal.setProductId(shippingTotalFrom.getProductId());\r\n\t\t\t\t\t\t\t\t\tselectToShippingTotal.setProvinceId(shippingTotalFrom.getProvinceId());\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tshippingTotalTo = daoManager.getProductDao().getShippingTotal(selectToShippingTotal);\r\n\t\t\t\t\t\t\t\t\tshippingTotalFrom.setUserId(to);\r\n\t\t\t\t\t\t\t\t\tif (shippingTotalTo != null) {\r\n\t\t\t\t\t\t\t\t\t\tshippingTotalFrom.setId(shippingTotalTo.getId());\r\n\t\t\t\t\t\t\t\t\t\tdaoManager.getProductDao().updateShippingTotal(shippingTotalFrom);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tdaoManager.getProductDao().insertShippingTotal(shippingTotalFrom);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tshippingTotalListFrom = null;\r\n\t\t\t\t\t\tshippingTotalTo = null;\r\n\t\t\t\t\t\tSelect selectToUserProductPrice = new Select();\r\n\t\t\t\t\t\tselectToUserProductPrice.setFrom(from);\r\n\t\t\t\t\t\tselectToUserProductPrice.setTo(to);\r\n\t\t\t\t\t\tselectToUserProductPrice.setUserId(to);\r\n\t\t\t\t\t\tList<UserProductPrice> userProductPriceListFrom = daoManager.getProductDao().getUserProductPriceByUserId(selectFrom);\r\n\t\t\t\t\t\tUserProductPrice userProductPriceTo = null;\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (userProductPriceListFrom != null && userProductPriceListFrom.size() > 0) {\r\n\t\t\t\t\t\t\tfor (UserProductPrice userProductPriceFrom : userProductPriceListFrom) { \r\n\t\t\t\t\t\t\t\tif (userProductPriceFrom != null) {\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tselectToUserProductPrice.setProductId(userProductPriceFrom.getProductId());\r\n\t\t\t\t\t\t\t\t\tuserProductPriceTo = daoManager.getProductDao().getUserProductPrice(selectToUserProductPrice);\r\n\t\t\t\t\t\t\t\t\tuserProductPriceFrom.setUserId(to);\r\n\t\t\t\t\t\t\t\t\tif (userProductPriceTo != null) {\r\n\t\t\t\t\t\t\t\t\t\tuserProductPriceFrom.setId(userProductPriceTo.getId());\r\n\t\t\t\t\t\t\t\t\t\tdaoManager.getProductDao().updateUserProductPrice(userProductPriceFrom);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tdaoManager.getProductDao().insertUserProductPriceShipping(userProductPriceFrom);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tuserProductPriceListFrom = null;\r\n\t\t\t\t\t\tuserProductPriceTo = null;\r\n\t\t\t\t\t\tselectFrom = null;\r\n\t\t\t\t\t\tselectToShippingTotal = null;\r\n\t\t\t\t\t\tselectToUserProductPrice = null;\t\t\t\t\t\t\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\t\t\r\n\t@Override\r\n\tpublic void transferSQLtheUserToNewTemplate(final Long from, final Long to) throws ServiceException {\r\n\t\ttry {\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tdaoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t\t@Override\r\n\t\t\t\t\tpublic Object execute(com.loyauty.dao.core.DaoManager daoManager)\r\n\t\t\t\t\t\t\tthrows DaoException {\r\n\t\t\t\t\t\tSelect select = new Select();\r\n\t\t\t\t\t\tselect.setFrom(from);\r\n\t\t\t\t\t\tselect.setTo(to);\r\n\t\t\t\t\t\tdaoManager.getProductDao().transferUserOnUserProvincePopulation(select);\r\n\t\t\t\t\t\tdaoManager.getProductDao().transferUserOnShippingTotal(select);\r\n\t\t\t\t\t\tdaoManager.getProductDao().transferUserOnUserProductPrice(select);\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (DaoException de) {\r\n\t\t\tthrow (new ServiceException(de));\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t@Override\r\n\tpublic Long isGroupProductID(final Long productId) throws ServiceException {\r\n\t\tLong count= 0L; \r\n\t\ttry{\r\n\t\t\tdaoManager.setCommitTransaction(true);\r\n\t\t\tcount = (Long) daoManager.executeAndHandle(new DaoCommand() {\r\n\t\t\t\t@Override\r\n\t\t\t\tpublic Object execute(DaoManager daoManager) throws DaoException {\t\t\t\r\n\t\t\t\t\treturn daoManager.getProductDao().isGroupProductID(productId);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}catch (DaoException de) {\r\n\t\t\ttry {\r\n\t\t\t\tthrow new ServiceException(de);\r\n\t\t\t} catch (ServiceException e) {\r\n\t\t\t\te.printStackTrace();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn count;\r\n\t}\t\t\r\n\r\n\t// transferSQLtheUserToNewTemplate(\r\n\t\r\n/*\r\n\t@Override\r\n\tpublic Boolean existsUserProductPrice(final Long productId, final Long userId) throws ServiceException {\r\n\t\tUserProductPriceDTO userProductPriceDTO = getUserProductPriceInformation(productId, userId);\r\n\t\treturn (userProductPriceDTO != null);\r\n\t}\r\n*/\r\n\t\r\n}\r\n\r\n----------------------------------- SOURCE END -------------------------------------",1403192930597
error,log,,,"Problems occurred when invoking code from plug-in: ""org.eclipse.jdt.ui"".",1403192930597
error,log,,,"Error in JDT Core during reconcile",1403192930597
activated,view,org.eclipse.wst.server.ui,1.1.207.v20110119,"org.eclipse.wst.server.ui.ServersView",1403192934201
executed,command,org.eclipse.wst.server.ui,1.1.207.v20110119,"org.eclipse.wst.server.run",1403192943873
activated,view,org.eclipse.ui.console,3.5.0.v20100526,"org.eclipse.ui.console.ConsoleView",1403192945495
activated,view,org.eclipse.wst.server.ui,1.1.207.v20110119,"org.eclipse.wst.server.ui.ServersView",1403192946712
activated,view,org.eclipse.ui.console,3.5.0.v20100526,"org.eclipse.ui.console.ConsoleView",1403192948819
deactivated,workbench,org.eclipse.ui.workbench,3.6.2.M20110210-1200,"",1403192973862
activated,workbench,org.eclipse.ui.workbench,3.6.2.M20110210-1200,"",1403192992135
activated,view,org.eclipse.wst.server.ui,1.1.207.v20110119,"org.eclipse.wst.server.ui.ServersView",1403192992135
activated,editor,org.eclipse.jst.jsp.ui,1.1.503.v201101262228,"org.eclipse.jst.jsp.core.jspsource.source",1403193027792
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.copy",1403193037495
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.copy",1403193037776
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.edit.paste",1403193040568
executed,command,org.eclipse.ui,3.6.2.M20110203-1100,"org.eclipse.ui.file.save",1403193051098
deactivated,workbench,org.eclipse.ui.workbench,3.6.2.M20110210-1200,"",1403193054000
activated,workbench,org.eclipse.ui.workbench,3.6.2.M20110210-1200,"",1403193964784
